/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/9.0.2
 * Generated at: 2018-05-11 08:08:35 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.WEB_002dINF.view.expense.outpatient.radt;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class opRegisterList_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(6);
    _jspx_dependants.put("jar:file:/E:/workspace.hisnew/hisbase/WebContent/WEB-INF/lib/jstl-1.2.jar!/META-INF/fn.tld", Long.valueOf(1153356282000L));
    _jspx_dependants.put("jar:file:/E:/workspace.hisnew/hisbase/WebContent/WEB-INF/lib/jstl-1.2.jar!/META-INF/c.tld", Long.valueOf(1153356282000L));
    _jspx_dependants.put("/WEB-INF/lib/jstl-1.2.jar", Long.valueOf(1525761782870L));
    _jspx_dependants.put("/commons/include/html_doctype.html", Long.valueOf(1525761798654L));
    _jspx_dependants.put("/commons/include/form.jsp", Long.valueOf(1525761798651L));
    _jspx_dependants.put("jar:file:/E:/workspace.hisnew/hisbase/WebContent/WEB-INF/lib/jstl-1.2.jar!/META-INF/fmt.tld", Long.valueOf(1153356282000L));
  }

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = null;
  }

  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fc_005fset_0026_005fvar_005fvalue_005fnobody;

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
    _005fjspx_005ftagPool_005fc_005fset_0026_005fvar_005fvalue_005fnobody = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
  }

  public void _jspDestroy() {
    _005fjspx_005ftagPool_005fc_005fset_0026_005fvar_005fvalue_005fnobody.release();
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET POST or HEAD");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html;charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write('\r');
      out.write('\n');
      out.write("<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">");
      out.write("\r\n");
      out.write("<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n");
      out.write("<head>\r\n");
      out.write("<title>门诊挂号列表</title>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      if (_jspx_meth_c_005fset_005f0(_jspx_page_context))
        return;
      out.write('\r');
      out.write('\n');
      if (_jspx_meth_c_005fset_005f1(_jspx_page_context))
        return;
      out.write("\r\n");
      out.write("<meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\" />\r\n");
      out.write("<!-- <meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE8\" /> -->\r\n");
      out.write("\r\n");
      out.write("<link href=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/styles/default/css/web.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/scripts/boot.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/commons/dynamic.jsp\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/scripts/plugins/misc/jquery.form.js\"></script>\r\n");
      out.write('\r');
      out.write('\n');
      out.write("\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/scripts/core.js\"></script>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/scripts/utils/idcard.js\"></script>\r\n");
      out.write("<script src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/scripts/plugins/report/CreateControl.js\"\r\n");
      out.write("\ttype=\"text/javascript\"></script>\r\n");
      out.write("<style type=\"text/css\">\r\n");
      out.write("\t\r\n");
      out.write("\t.mini-tabs-bodys {\r\n");
      out.write("\t\tborder: 0px;\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t.mini-panel-border {\r\n");
      out.write("\t\tborder: 1px solid #c5c5c5;\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t.form-label {\r\n");
      out.write("\t\ttext-align: right;\r\n");
      out.write("\t\twidth: 70px;\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tfieldset {\r\n");
      out.write("\t\tborder: solid 1px #c5c5c5;\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t.required {\r\n");
      out.write("\t\tcolor: #006aad;\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t.myrow {\r\n");
      out.write("\t\tcolor: red;\r\n");
      out.write("\t}\t\r\n");
      out.write("</style>\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\r\n");
      out.write("\t// 添加一个全局变量 EnumLimit来区别数据的验证级别\r\n");
      out.write("\tvar limitPhoneAndAddress = \"half\";\r\n");
      out.write("\r\n");
      out.write("\t// 根据输入的名字查询是否有该患者\r\n");
      out.write("\tfunction havePatient () {\r\n");
      out.write("\t\tgrid4.deselectAll();\r\n");
      out.write("\t\tif (patientName.value.isEmpty()) {\r\n");
      out.write("// \t\t\ttop.mini.alert(\"姓名不能为空，请重新输入\");\r\n");
      out.write("\t\t\treturn; \r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/medical/common/patient/getByNameOrPhone.do\";\r\n");
      out.write("\t\t$.post(url, {patientName: patientName.value}, function(r) {\r\n");
      out.write("\t\t\tvar count = r.length;\r\n");
      out.write("\t\t\tif(count > 0){// 如果根据姓名查到信息，弹出供选择\r\n");
      out.write("\t\t\t\twin.setTitle(\"患者信息\");\r\n");
      out.write("\t\t\t\twin.show();\r\n");
      out.write("\t\t\t\tgrid5.loadData(r);\r\n");
      out.write("\t\t\t\tgrid5.focus();\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tchangeTab(\"birthDate\");\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 结算种类 结算类别 二级联动\r\n");
      out.write("\tfunction changeMedicaltype () {\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/common/medicalTypeKind/getKVs.do?blank=0\"\r\n");
      out.write("\t\t\t\t  \t+\"&medicaltypeId=\" + patientMedicaltypeId.value;\r\n");
      out.write("\t\tpatientMedicaltypeKindId.load(url);\r\n");
      out.write("\t} \r\n");
      out.write("\t\r\n");
      out.write("\t// 查询挂号级别项目综合信息\r\n");
      out.write("\tfunction showRegLevelItemList (e) {\r\n");
      out.write("\t\tif(e.source.id == \"reglevelId\") {\r\n");
      out.write("\t\t\tdeptId.setValue();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tif(e.source.id != \"grid3\" && e.source.id != \"appointment\" && e.source.id != \"patientMedicaltypeKindId\") {\r\n");
      out.write("\t\t\tscheduleId.setValue();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tif(e.source.id != \"appointment\") {\r\n");
      out.write("\t\t\tappointmentId.setValue(\"-1\");\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar medicalTypeKindId = \"\";\r\n");
      out.write("\t\tvar seeDateValue = mini.formatDate(new Date(), \"yyyy-MM-dd\");\r\n");
      out.write("\t\tvar currentHourValue = mini.formatDate(new Date(), \"H\");\r\n");
      out.write("\t\tif (patientMedicaltypeKindId.value.isEmpty()) {\r\n");
      out.write("\t\t\tmedicalTypeKindId = \"NULL\";\r\n");
      out.write("\t\t} else {\r\n");
      out.write("\t\t\tmedicalTypeKindId = patientMedicaltypeKindId.value;\r\n");
      out.write("\t\t}\r\n");
      out.write("\r\n");
      out.write("\t\tgrid2.load({\r\n");
      out.write("\t\t\tmedicalTypeKindId: medicalTypeKindId,\r\n");
      out.write("\t\t\treglevelId: reglevelId.value\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tgrid3.load({ // aaa\r\n");
      out.write("\t\t\treglevelId: reglevelId.value,\r\n");
      out.write("\t\t\tseeDate: seeDateValue,\r\n");
      out.write("\t\t\tcurrentHour: currentHourValue,\r\n");
      out.write("\t\t\tdeptId: deptId.value,\r\n");
      out.write("\t\t\tdoctId: doctId.value\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t\r\n");
      out.write("\t// 挂号级别改变时\r\n");
      out.write("\tfunction onRegLevelChanged() {\r\n");
      out.write("\t\tdeptId.setValue(\"\");\r\n");
      out.write("\t\tdeptId.setData(null);\r\n");
      out.write("\t\tdoctId.setValue(\"\");\r\n");
      out.write("\t\tdoctId.setData(null);\r\n");
      out.write("\t\tscheduleId.setValue(\"\");\r\n");
      out.write("\t\tscheduleId.setData(null);\r\n");
      out.write("\t\tscheduleTimeId.setValue(\"\");\r\n");
      out.write("\t\tscheduleTimeId.setData(null);\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 加载挂号科室 和 挂号医生 下拉框数据\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/schedule/selectedRegLevel.do\";\r\n");
      out.write("\t\tvar data = {reglevelId : reglevelId.value};\r\n");
      out.write("\t\t$.post(url, data , function(r) {\r\n");
      out.write("\t\t\tif(r == \"no\") {\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tdeptId.setData(r.cmbRegDept);\r\n");
      out.write("\t\t\tdoctId.setData(r.cmbRegDoctor);\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 挂号费用项目加载\r\n");
      out.write("\t\tvar medicalTypeKindId = \"\";\r\n");
      out.write("\t\tif (patientMedicaltypeKindId.value.isEmpty()) {\r\n");
      out.write("\t\t\tmedicalTypeKindId = \"NULL\";\r\n");
      out.write("\t\t} else {\r\n");
      out.write("\t\t\tmedicalTypeKindId = patientMedicaltypeKindId.value;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tgrid2.load({\r\n");
      out.write("\t\t\tmedicalTypeKindId: medicalTypeKindId,\r\n");
      out.write("\t\t\treglevelId: reglevelId.value\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 出诊信息过滤\r\n");
      out.write("\t\tgrid3.load({reglevelId: reglevelId.value});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 挂号科室改变时\r\n");
      out.write("\tfunction deptChanged() {\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tdoctId.setValue(\"\");\r\n");
      out.write("\t\tdoctId.setData(null);\r\n");
      out.write("\t\tscheduleId.setValue(\"\");\r\n");
      out.write("\t\tscheduleId.setData(null);\r\n");
      out.write("\t\tscheduleTimeId.setValue(\"\");\r\n");
      out.write("\t\tscheduleTimeId.setData(null);\r\n");
      out.write("\t\tif(!deptId.value) {\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t// 加载看诊日期 和 挂号医生 下拉框数据\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/schedule/selectedRegDept.do\";\r\n");
      out.write("\t\tvar data = {\r\n");
      out.write("\t\t\treglevelId : reglevelId.value,\r\n");
      out.write("\t\t\tdeptId : deptId.value\r\n");
      out.write("\t\t};\r\n");
      out.write("\t\t$.post(url, data , function(r) {\r\n");
      out.write("\t\t\tif(r == \"no\") {\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tif(!r.cmbRegDoctor) {\r\n");
      out.write("\t\t\t\tscheduleId.setData(r.cmbSeeTime);\r\n");
      out.write("\t\t\t} else {\r\n");
      out.write("\t\t\t\tdoctId.setData(r.cmbRegDoctor);\r\n");
      out.write("\t\t\t\tscheduleId.setData(r.cmbSeeTime);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 出诊信息过滤\r\n");
      out.write("\t\tgrid3.load({\r\n");
      out.write("\t\t\treglevelId: reglevelId.value,\r\n");
      out.write("\t\t\tdeptId: deptId.value\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 挂号医生改变时\r\n");
      out.write("\tfunction doctChanged() {\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tscheduleId.setValue(\"\");\r\n");
      out.write("\t\tscheduleId.setData(null);\r\n");
      out.write("\t\tscheduleTimeId.setValue(\"\");\r\n");
      out.write("\t\tscheduleTimeId.setData(null);\r\n");
      out.write("\t\tif(!deptId.value) {\r\n");
      out.write("\t\t\t// 出诊信息过滤\r\n");
      out.write("\t\t\tgrid3.load({\r\n");
      out.write("\t\t\t\treglevelId: reglevelId.value,\r\n");
      out.write("\t\t\t\tdoctId: doctId.value\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t} else {\r\n");
      out.write("\t\t\t// 看诊日期 下拉框赋值\r\n");
      out.write("\t\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/schedule/selectedRegDoctor.do\";\r\n");
      out.write("\t\t\tvar data = {\r\n");
      out.write("\t\t\t\treglevelId : reglevelId.value,\r\n");
      out.write("\t\t\t\tdeptId : deptId.value,\r\n");
      out.write("\t\t\t\tdoctId: doctId.value\r\n");
      out.write("\t\t\t};\r\n");
      out.write("\t\t\t$.post(url, data , function(r) {\r\n");
      out.write("\t\t\t\tif(r == \"no\") {\r\n");
      out.write("\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tscheduleId.setData(r.cmbSeeTime);\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t// 出诊信息过滤\r\n");
      out.write("\t\t\t\tgrid3.load({\r\n");
      out.write("\t\t\t\t\treglevelId: reglevelId.value,\r\n");
      out.write("\t\t\t\t\tdeptId: deptId.value,\r\n");
      out.write("\t\t\t\t\tdoctId: doctId.value\r\n");
      out.write("\t\t\t\t});\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 看诊日期改变时\r\n");
      out.write("\tfunction scheduleChanged() {\r\n");
      out.write("\t\t// 看诊序号 下拉框赋值\r\n");
      out.write("\t\tif(!scheduleId.value || scheduleId.value == \"NULL\") {\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/schedule/seeTimeChanged.do\";\r\n");
      out.write("\t\tvar data = {\r\n");
      out.write("\t\t\t\tscheduleId : scheduleId.value,\r\n");
      out.write("\t\t\t\tregisterClass : registerClass.value\r\n");
      out.write("\t\t\t};\r\n");
      out.write("\t\t$.post(url, data , function(r) {\r\n");
      out.write("\t\t\tif(r.state == \"error\") {\r\n");
      out.write("\t\t\t\ttop.mini.alert(r.msg);\r\n");
      out.write("\t\t\t\tscheduleId.setValue(\"\");\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tscheduleTimeId.setData(r.cmbSeeSerailId);\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\t// 双击出诊信息\r\n");
      out.write("\tfunction showScheduleInfo (e) {\r\n");
      out.write("\r\n");
      out.write("\t\tvar row = e.row;\r\n");
      out.write("\t\tif(!row) {\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("// \t\treglevelId.setValue(row.reglevelId);\r\n");
      out.write("// \t\tdeptId.setValue(row.deptId);\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/schedule/scheduleDoubleClick.do\";\r\n");
      out.write("\t\tvar data = {\r\n");
      out.write("\t\t\t\tscheduleId : row.scheduleId,\r\n");
      out.write("\t\t\t\tregisterClass : registerClass.value\r\n");
      out.write("\t\t\t};\r\n");
      out.write("\t\t$.post(url, data , function(r) {\r\n");
      out.write("\t\t\tif(r.state == \"error\") {\r\n");
      out.write("\t\t\t\ttop.mini.alert(r.msg);\r\n");
      out.write("// \t\t\t\tscheduleId.setValue(null);\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("// \t\t\tscheduleTimeId.setData(r.cmbSeeSerailId);\r\n");
      out.write("\t\t\tdeptId.setData(r.cmbRegDept);\r\n");
      out.write("\t\t\tdoctId.setData(r.cmbRegDoctor);\r\n");
      out.write("\t\t\tscheduleId.setData(r.cmbSeeTime);\r\n");
      out.write("\t\t\tscheduleTimeId.setData(r.cmbSeeSerailId);\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\treglevelId.setValue(r.reglevelId);\r\n");
      out.write("\t\t\tdeptId.setValue(r.deptId);\r\n");
      out.write("\t\t\tdoctId.setValue(r.doctId);\r\n");
      out.write("\t\t\tscheduleId.setValue(r.scheduleId);\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t// 挂号费用项目加载\r\n");
      out.write("\t\t\tvar medicalTypeKindId = \"\";\r\n");
      out.write("\t\t\tif (patientMedicaltypeKindId.value.isEmpty()) {\r\n");
      out.write("\t\t\t\tmedicalTypeKindId = \"NULL\";\r\n");
      out.write("\t\t\t} else {\r\n");
      out.write("\t\t\t\tmedicalTypeKindId = patientMedicaltypeKindId.value;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tgrid2.load({\r\n");
      out.write("\t\t\t\tmedicalTypeKindId: medicalTypeKindId,\r\n");
      out.write("\t\t\t\treglevelId: reglevelId.value\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t// 出诊信息过滤\r\n");
      out.write("\t\t\tgrid3.load({scheduleId : row.scheduleId});\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 验证身份证号并计算生日、性别\r\n");
      out.write("\tfunction onIDCardValidation (e) {\r\n");
      out.write("\t\tvar idCard = new IDCard(idnetifierNo.value);\r\n");
      out.write("\t\tif(!idCard.isValid()) { \r\n");
      out.write("\t\t\tif (idnetifierTypeId.value == \"01\") {\r\n");
      out.write("\t\t\t\t e.errorText = \"请输入有效身份证号\";\r\n");
      out.write("\t\t\t\t e.isValid = false;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tchangeTab(\"patientMedicaltypeId\");\r\n");
      out.write("\t\t} else {\r\n");
      out.write("\t\t\tidnetifierNo.setErrorMode(\"none\");\r\n");
      out.write("\t\t  \tvar birthDay = idCard.getBirthday();\r\n");
      out.write("\t\t  \tbirthDate.setValue(birthDay);\r\n");
      out.write("\t\t    var sex = idCard.getSex();\r\n");
      out.write("\t\t    sexCode.setValue(sex);\r\n");
      out.write("\t\t    idnetifierTypeId.setValue(\"01\");\r\n");
      out.write("\t\t    getAge();\r\n");
      out.write("\t\t    \r\n");
      out.write("\t\t    changeTab(\"patientMedicaltypeId\");\r\n");
      out.write("\t\t }\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 通过输入的出生日期计算当前年龄\r\n");
      out.write("\tfunction getAge () {\r\n");
      out.write("\t\tvar birthYear = mini.formatDate(birthDate.value,\"yyyy\");\r\n");
      out.write("\t\tvar nowYear = mini.formatDate(new Date(),\"yyyy\");\r\n");
      out.write(" \t\tif(nowYear - birthYear < 0 || nowYear - birthYear > 150) {\r\n");
      out.write("\t\t\tmini.showTips({content:\"出生日期异常\",state:\"warning\",x:\"center\",y:\"center\",timeout:3000});\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write(" \t\tageNum.setValue(nowYear - birthYear);\r\n");
      out.write("\t\tageType.setValue(\"1\");\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tchangeTab(\"sexCode\");\r\n");
      out.write(" \t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 计算挂号信息栏的总金额 和 记账总金额\r\n");
      out.write("\tfunction calculateCost () {\r\n");
      out.write("\t\tvar sum = 0;\r\n");
      out.write("\t\tvar sum2 = 0\r\n");
      out.write("\t\tfor (var i=0; i < grid2.totalCount; i++) {\r\n");
      out.write("\t\t\tif (grid2.getRow(i).fixedFlag == \"1\") {\r\n");
      out.write("\t\t\t\tsum = sum + grid2.getRow(i).totCost;\r\n");
      out.write("\t\t\t\tsum2 = sum2 + grid2.getRow(i).pubCost;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\ttotalCost.setValue(sum-sum2);\r\n");
      out.write("\t\ttotalPubCost.setValue(sum2);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 编辑开始前事件\r\n");
      out.write("\tfunction oncellbeginedit(e) {\r\n");
      out.write("\t\tif (e.row.fixedFlag == 1) {\r\n");
      out.write("\t\t\ttotalCost.setValue(eval(totalCost.value + \"-\" + e.row.totCost + \"+\" + e.row.pubCost));\r\n");
      out.write("\t\t} else {\r\n");
      out.write("\t\t\ttotalCost.setValue(eval(totalCost.value + \"+\" + e.row.totCost + \"-\" + e.row.pubCost));\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 回填挂号列表某个患者的信息\r\n");
      out.write("\tfunction showPatientInfo (e) {\r\n");
      out.write("\t\tvar selected = grid4.getSelected();\r\n");
      out.write("\t\tif (!selected) {\r\n");
      out.write("\t\t\tselected = e;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t$.ajax({\r\n");
      out.write("\t\t    url: \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/getPatient.do?patientId=\" + selected.patientId,\r\n");
      out.write("\t\t    type: \"post\",\r\n");
      out.write("\t\t    success: function (r) {\r\n");
      out.write("\t\t    \tvar ageNumValue = r.age.substring(0, r.age.length-1);\r\n");
      out.write("\t\t    \tvar ageTypeValue = r.age.substring(r.age.length-1);\r\n");
      out.write("\t\t    \tif (ageTypeValue == \"Y\") {\r\n");
      out.write("\t\t    \t\tr.ageNum = ageNumValue;\r\n");
      out.write("\t\t    \t\tr.ageType = \"1\";\r\n");
      out.write("\t\t    \t} else if (ageTypeValue == \"M\") {\r\n");
      out.write("\t\t    \t\tr.ageNum = ageNumValue;\r\n");
      out.write("\t\t    \t\tr.ageType = \"2\";\r\n");
      out.write("\t\t    \t} else if (ageTypeValue == \"D\") {\r\n");
      out.write("\t\t    \t\tr.ageNum = ageNumValue;\r\n");
      out.write("\t\t    \t\tr.ageType = \"3\";\r\n");
      out.write("\t\t    \t} else if (ageTypeValue == \"H\") {\r\n");
      out.write("\t\t    \t\tr.ageNum = 0;\r\n");
      out.write("\t\t    \t\tr.ageType = \"3\";\r\n");
      out.write("\t\t    \t}\r\n");
      out.write("\t\t    \tr.presentAddress = r.address;\r\n");
      out.write("\t\t        var data = mini.decode(r);   \r\n");
      out.write("\t\t        form1.setData(data);\r\n");
      out.write("\t\t        mini.get(\"name\").setValue(r.patientName);\r\n");
      out.write("\t\t        allowUpdatePatient(false);\r\n");
      out.write("\t\t    }\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 预约号检索\r\n");
      out.write("\tfunction setAppointment() {\r\n");
      out.write("\t\tvar appointmentId = mini.get(\"appointmentNo\").value;\r\n");
      out.write("\t\tif(!appointmentId) {\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/medical/outpatient/opExpRegister/setAppointment.do\";\r\n");
      out.write("\t\tvar data = {appointmentId : appointmentId};\r\n");
      out.write("\t\t$.post(url, data , function(r) {\r\n");
      out.write("\t\t\tif(r.state == \"ok\") {\r\n");
      out.write("\t\t\t\tdeptId.setData(r.cmbRegDept);\r\n");
      out.write("        \t\tdoctId.setData(r.cmbRegDoctor);\r\n");
      out.write("        \t\tscheduleId.setData(r.cmbSeeTime);\r\n");
      out.write("        \t\tparentForm.setData(r);\r\n");
      out.write("        \t\tchangeMedicaltype();\r\n");
      out.write("        \t\t\r\n");
      out.write("        \t\tallowUpdatePatient(false);\r\n");
      out.write("        \t\tallowUpdateRegister(false);\r\n");
      out.write("\t\t\t} else {\r\n");
      out.write("\t\t\t\ttop.mini.alert(r);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 选择预约(页面)\r\n");
      out.write("\tfunction appointmentView (e) {\r\n");
      out.write("\t\tmini.open({\r\n");
      out.write("            url: \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/appointment.do\",\r\n");
      out.write("            title: \"选择预约\", \r\n");
      out.write("            width: 900, \r\n");
      out.write("            height: 500,\r\n");
      out.write("            ondestroy: function (r) {\r\n");
      out.write("            \tif (r.type == \"yes\") {\r\n");
      out.write("            \t\tdeptId.setData(r.cmbRegDept);\r\n");
      out.write("            \t\tdoctId.setData(r.cmbRegDoctor);\r\n");
      out.write("            \t\tscheduleId.setData(r.cmbSeeTime);\r\n");
      out.write("            \t\tparentForm.setData(r);\r\n");
      out.write("            \t\tchangeMedicaltype();\r\n");
      out.write("            \t\tpatientMedicaltypeKindId.setValue(r.patientMedicaltypeKindId);\r\n");
      out.write("            \t\t\r\n");
      out.write("            \t\tallowUpdatePatient(false);\r\n");
      out.write("            \t\tallowUpdateRegister(false);\r\n");
      out.write("            \t\t\r\n");
      out.write("            \t\t// 挂号费用项目加载\r\n");
      out.write("            \t\tgrid2.load({\r\n");
      out.write("            \t\t\tmedicalTypeKindId: r.patientMedicaltypeKindId,\r\n");
      out.write("            \t\t\treglevelId: r.reglevelId\r\n");
      out.write("            \t\t});\r\n");
      out.write("            \t}\r\n");
      out.write("        \t} \r\n");
      out.write("        }); \r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 禁用或开启 患者信息修改功能\r\n");
      out.write("\tfunction allowUpdatePatient (sign) {\r\n");
      out.write("\t\tpatientName.set({enabled: sign});\r\n");
      out.write("        birthDate.set({enabled: sign});\r\n");
      out.write("        sexCode.set({enabled: sign});\r\n");
      out.write("//         idnetifierTypeId.set({enabled: sign});\r\n");
      out.write("//         idnetifierNo.set({enabled: sign});\r\n");
      out.write("        ageNum.set({enabled: sign});\r\n");
      out.write("        ageType.set({enabled: sign});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 禁用或开启 挂号信息修改功能\r\n");
      out.write("\tfunction allowUpdateRegister (sign) {\r\n");
      out.write("\t\treglevelId.set({enabled: sign});\r\n");
      out.write("\t\tdeptId.set({enabled: sign});\r\n");
      out.write("\t\tdoctId.set({enabled: sign});\r\n");
      out.write("\t\tscheduleId.set({enabled: sign});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 铁路读卡(页面)\r\n");
      out.write("\tfunction railwayReading () {\r\n");
      out.write("\t\tmini.open({\r\n");
      out.write("            url: \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/railwayReading.do\",\r\n");
      out.write("            title: \"广铁医保读卡\", \r\n");
      out.write("            width: 500, \r\n");
      out.write("            height: 560,\r\n");
      out.write("            ondestroy: function (r) {\r\n");
      out.write("            \treturn;\r\n");
      out.write("        \t} \r\n");
      out.write("        }); \r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 挂号前需要一系列验证\r\n");
      out.write("\tfunction registerValidation () {\r\n");
      out.write("\t\tform1.validate();\r\n");
      out.write("\t\tform2.validate();\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tif (!form1.isValid() || !form2.isValid()) {\r\n");
      out.write("\t\t    top.mini.alert(\"请校验输入单元格内容\");\r\n");
      out.write("\t\t    return;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 校验证件号码\r\n");
      out.write("\t\tvar idnetifierTypeId = mini.get(\"idnetifierTypeId\").getValue();\r\n");
      out.write("\t\tvar idnetifierNo = mini.get(\"idnetifierNo\").getValue();\r\n");
      out.write("\t\tif(!idnetifierTypeId && idnetifierNo) {\r\n");
      out.write("\t\t\tmini.alert(\"请选择证件类型\");\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tif(idnetifierTypeId && !idnetifierNo) {\r\n");
      out.write("\t\t\tmini.alert(\"请填写证件号码\");\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tif(idnetifierTypeId == \"01\" && !(new IDCard(idnetifierNo)).isValid()) {\r\n");
      out.write("\t\t\tmini.alert(\"身份证格式错误\");\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 校验出生日期\r\n");
      out.write("\t\tvar birthYear = mini.formatDate(birthDate.value,\"yyyy\");\r\n");
      out.write("\t\tvar nowYear = mini.formatDate(new Date(),\"yyyy\");\r\n");
      out.write(" \t\tif(nowYear - birthYear < 0 || nowYear - birthYear > 150) {\r\n");
      out.write("\t\t\tmini.showTips({content:\"出生日期异常\",state:\"warning\",x:\"center\",y:\"center\",timeout:3000});\r\n");
      out.write("\t\t\tbirthDate.setValue(\"\");\r\n");
      out.write("\t\t\tmini.get(\"ageNum\").setValue(\"\");\r\n");
      out.write("\t\t\tmini.get(\"ageType\").setValue(\"\");\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 手机号 地址 验证\t\r\n");
      out.write("\t\tvar reg = /^1([358][0-9]|4[579]|66|7[0135678]|9[89])[0-9]{8}$/;\r\n");
      out.write("\t\tif (limitPhoneAndAddress == \"half\") {\r\n");
      out.write("\t\t\tif(!form1.getData().phone && !form1.getData().presentAddress) {\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\ttop.mini.alert(\"手机号码和地址不能同时为空,必须输入一个\");\r\n");
      out.write("\t\t\t\treturn ;\r\n");
      out.write("\t\t\t} else if(form1.getData().phone) {\r\n");
      out.write("\t\t\t\tvar phoneStr = form1.getData().phone;\r\n");
      out.write("\t\t\t\tif(!(reg.test(phoneStr))){ \r\n");
      out.write("\t\t\t        mini.alert(\"手机号码有误，请重填\");  \r\n");
      out.write("\t\t\t        return; \r\n");
      out.write("\t\t\t    } \r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t} else if(limitPhoneAndAddress == \"all\") {\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\tif(!form1.phone || !form1.presentAddress) {\r\n");
      out.write("\t\t\t\ttop.mini.alert(\"手机号码和地址都不能为空!\");\r\n");
      out.write("\t\t\t\treturn ;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\tif(!(reg.test(phoneStr))){ \r\n");
      out.write("\t\t        alert(\"手机号码有误，请重填\");  \r\n");
      out.write("\t\t        return; \r\n");
      out.write("\t\t    } \r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tif(form1.getData().birthDate.getTime() > new Date().getTime()) {\r\n");
      out.write("\t\t\ttop.mini.alert(\"出生日期不能大于当前时间！\");\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\r\n");
      out.write("\t\t// add By Leen(添加验证) register验证\r\n");
      out.write("\t\tif(form2.reglevelId == 3 && !form2.doctId) {\r\n");
      out.write("\t\t\ttop.mini.alert(\"专家号必须指定挂号医生\");\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t};\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 页面未清空提示\r\n");
      out.write("\t\t/* if(patientId.value && patientName.value != mini.get(\"name\").getValue()) {\r\n");
      out.write("\t\t\ttop.mini.confirm(\"唯一号\" + patientId.value + \"是【\" + mini.get(\"name\").getValue() + \"】的，不是当前【\" + patientName.value + \r\n");
      out.write("\t\t\t\t\t\"】的。 </br>建议点否然后清空重挂，继续则会赋予新的唯一号给当前【\" + patientName.value + \"】。</br>是否继续？\", \r\n");
      out.write("\t\t\t\t\t' 提示 ', function(o) {\r\n");
      out.write("\t\t\t\tif (o == \"ok\") {\r\n");
      out.write("\t\t\t\t\tconfirmPay();\r\n");
      out.write("\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\trefresh();\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t} */\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tif(totalCost.value <= 0) {// 无费挂号\r\n");
      out.write("\t\t\tregisterWithNoCost();\r\n");
      out.write("\t\t} else {\r\n");
      out.write("// \t\t\tconfirmPay();\r\n");
      out.write("\t\t\tregisterView();// 打开支付弹窗\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 挂号(弹窗)\r\n");
      out.write("\tfunction registerView () {\r\n");
      out.write("\t\t// 请求打开弹窗时 启用页面遮罩，防止操作员多次点击按钮，发出多次请求\r\n");
      out.write("\t\tmini.mask({\r\n");
      out.write("                    el: document.body,\r\n");
      out.write("                    cls: 'mini-mask-loading',\r\n");
      out.write("                    html: '加载中...'\r\n");
      out.write("                }); \r\n");
      out.write("\t\t\r\n");
      out.write("\t\tmini.open({\r\n");
      out.write("            url: \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/register.do?patientId=\" + patientId.value \r\n");
      out.write("            \t\t+ \"&totalCost=\" + totalCost.value + \"&totalPubCost=0\"  \r\n");
      out.write("            \t\t+ \"&patientMedicaltypeId=\" + patientMedicaltypeId.value,\r\n");
      out.write("            title: \"选择支付方式\", \r\n");
      out.write("            width: 700, \r\n");
      out.write("            height: 500,\r\n");
      out.write("            onload: function () {      \r\n");
      out.write("                var iframe = this.getIFrameEl(); \r\n");
      out.write("                var data = {\r\n");
      out.write("                \t\t    patientName:patientName.value,\r\n");
      out.write("                \t\t    sexCode:sexCode.value,\r\n");
      out.write("                \t\t    patientMedicaltypeId:patientMedicaltypeId.value\r\n");
      out.write("                \t\t    \r\n");
      out.write("                \t\t};       \r\n");
      out.write("                iframe.contentWindow.SetData(data); \r\n");
      out.write("            },\r\n");
      out.write("            \r\n");
      out.write("            ondestroy : function (r) {\r\n");
      out.write("            \t// 弹框关闭时取消遮罩\r\n");
      out.write("            \tmini.unmask();\r\n");
      out.write("            \t\r\n");
      out.write("            \tif (r.type == \"ok\") {\r\n");
      out.write("            \t\t\r\n");
      out.write("            \t\tmini.mask({\r\n");
      out.write("                        el: document.body,\r\n");
      out.write("                        cls: 'mini-mask-loading',\r\n");
      out.write("                        html: '加载中...'\r\n");
      out.write("                    }); \r\n");
      out.write("            \t\t\r\n");
      out.write("            \t\tvar data = parentForm.getData();\r\n");
      out.write("            \t\tdata.regLevelItemList = mini.encode(grid2.getList());\r\n");
      out.write("   \t\t\t\t\tdata.address = data.presentAddress;\r\n");
      out.write("   \t\t\t\t\tdata.registerDeptId = data.deptId;\r\n");
      out.write("   \t\t\t\t\tdata.registerDoctId = data.doctId;\r\n");
      out.write("   \t\t\t\t\tdata.patientMedicaltypeKind = data.patientMedicaltypeKindId;\r\n");
      out.write("   \t\t\t\t\tdata.schemaId = data.scheduleId;\r\n");
      out.write("   \t\t\t\t \tdata.paymentList = mini.encode(r.paymentList);\r\n");
      out.write("   \t\t\t\t \tdata.registerClass = mini.get(\"registerClass\").getValue();\r\n");
      out.write("   \t\t\t\t \r\n");
      out.write("   \t\t\t\t\t$.post(\r\n");
      out.write("   \t            \t\t\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/medical/outpatient/opExpRegister/registerHandle.do\",\r\n");
      out.write("   \t            \t\tdata,\r\n");
      out.write("   \t           \t\t\tfunction (r) {\r\n");
      out.write("   \t            \t\t\tmini.unmask();\r\n");
      out.write("   \t            \t\t\t\r\n");
      out.write("   \t            \t\t\tif (r.state == \"ok\") {\r\n");
      out.write("   \t           \t\t\t\t\ttop.mini.alert(\"挂号成功\");\r\n");
      out.write("   \t           \t\t\t\t\texecPrint(r.registerId);\r\n");
      out.write("   \t           \t\t\t\t\trefresh();\r\n");
      out.write("   \t           \t\t\t\t} else {\r\n");
      out.write("   \t           \t\t\t\t\ttop.mini.error(r);\r\n");
      out.write("   \t           \t\t\t\t}\r\n");
      out.write("   \t           \t\t\t}\r\n");
      out.write("   \t            \t); \r\n");
      out.write("   \t\t\t\t}\r\n");
      out.write("        \t} \r\n");
      out.write("        }); \r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 无费挂号\r\n");
      out.write("\tfunction registerWithNoCost() {\r\n");
      out.write("\t\tvar data = parentForm.getData();\r\n");
      out.write("\t\tdata.regLevelItemList = mini.encode(grid2.getList());\r\n");
      out.write("\t\tdata.address = data.presentAddress;\r\n");
      out.write("\t\tdata.registerDeptId = data.deptId;\r\n");
      out.write("\t\tdata.registerDoctId = data.doctId;\r\n");
      out.write("\t\tdata.patientMedicaltypeKind = data.patientMedicaltypeKindId;\r\n");
      out.write("\t\tdata.schemaId = data.scheduleId;\r\n");
      out.write("\t \tdata.paymentList = [];\r\n");
      out.write("\t \tdata.registerClass = mini.get(\"registerClass\").getValue();\r\n");
      out.write("\t \t\r\n");
      out.write("\t\t$.post(\r\n");
      out.write("      \t\t\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/medical/outpatient/opExpRegister/registerHandle.do\",\r\n");
      out.write("      \t\tdata,\r\n");
      out.write("     \t\t\tfunction (r) {\r\n");
      out.write("     \t\t\t\tif (r.state == \"ok\") {\r\n");
      out.write("     \t\t\t\t\ttop.mini.alert(\"挂号成功\");\r\n");
      out.write("     \t\t\t\t\texecPrint(r.registerId);\r\n");
      out.write("     \t\t\t\t\trefresh();\r\n");
      out.write("     \t\t\t\t\t\r\n");
      out.write("     \t\t\t\t} else {\r\n");
      out.write("     \t\t\t\t\ttop.mini.error(r);\r\n");
      out.write("     \t\t\t\t}\r\n");
      out.write("     \t\t\t}\r\n");
      out.write("      \t); \r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 发票累计(页面)\r\n");
      out.write("\tfunction receiptView () {\r\n");
      out.write("\t\tmini.open({\r\n");
      out.write("            url: \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/receiptStatistics.do\",\r\n");
      out.write("            title: \"发票累计\", \r\n");
      out.write("            width: 1000, \r\n");
      out.write("            height: 400,\r\n");
      out.write("            ondestroy: function (r) {\r\n");
      out.write("            \treturn;\r\n");
      out.write("        \t} \r\n");
      out.write("        }); \r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 清空\r\n");
      out.write("\tfunction refresh() {\r\n");
      out.write("\t\tlocation.reload();\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 出诊医生 挂号医生 下拉框渲染\r\n");
      out.write("\tfunction onDrawDoctCell (e) {\r\n");
      out.write("\t\tvar item = e.record, field = e.field, value = e.value;\r\n");
      out.write("        //组织HTML设置给cellHtml\r\n");
      out.write("        e.cellHtml = item.id + \".\" + item.text;   \r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 看诊序号 下拉框渲染\r\n");
      out.write("\t/* function onDrawSeeSerialCell (e) {\r\n");
      out.write("\t\tvar item = e.record;\r\n");
      out.write("\t\tvar textDraw = mini.formatDate (item.text,\"HH:mm\");\r\n");
      out.write("\t\te.cellHtml = item.id + \"号.\" + textDraw;  \r\n");
      out.write("\t} */\r\n");
      out.write("\t\r\n");
      out.write("\t// 看诊时间渲染\r\n");
      out.write("\tfunction ondrawcell(e) {\r\n");
      out.write("\t\tvar row = e.row;\r\n");
      out.write("\t\tvar seeDate = mini.formatDate(row.seeDate, \"yyyy-MM-dd\");\r\n");
      out.write("\t\tvar noonName = row.seeNoonCode == \"1\" ? \"上午\" : \"下午\";\r\n");
      out.write("\t\tvar startTime = mini.formatDate(row.seeBeginTime, \"HH:mm\");\r\n");
      out.write("\t\tvar endTime = mini.formatDate(row.seeEndTime, \"HH:mm\");\r\n");
      out.write("\t\tvar week = parseInt(row.week);\r\n");
      out.write("\t\tswitch(week) {\r\n");
      out.write("\t\tcase 1:\r\n");
      out.write("\t\t\tweek = \"一\";\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 2:\r\n");
      out.write("\t\t\tweek = \"二\";\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 3:\r\n");
      out.write("\t\t\tweek = \"三\";\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 4:\r\n");
      out.write("\t\t\tweek = \"四\";\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 5:\r\n");
      out.write("\t\t\tweek = \"五\";\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 6:\r\n");
      out.write("\t\t\tweek = \"六\";\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 0:\r\n");
      out.write("\t\t\tweek = \"天\";\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tif(e.column.field == \"seeDate\") {\r\n");
      out.write("\t\t\te.cellHtml = seeDate + \" (\"+startTime+\"~\"+endTime+\") \" + noonName + \" 星期\" + week; \r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 收费grid2加载完毕后对记账金额作处理\r\n");
      out.write("\tfunction ondrawcell2(e) {\r\n");
      out.write("\t\tvar row = e.row;\r\n");
      out.write("\t\tvar age = ageNum.getValue();\r\n");
      out.write("\t\tvar sex = sexCode.getValue();\r\n");
      out.write("\t\tvar ageKind = ageType.getValue();\r\n");
      out.write("\t\t// 如果这个患者的年龄达到了免挂单费用的年龄\r\n");
      out.write("\t\tif(e.column.field == \"pubCost\") {\r\n");
      out.write("\t\t\tif((parseInt(row.FreeWonmanAge) < parseInt(age) && sex == \"2\" && ageKind == \"岁\") \r\n");
      out.write("\t\t\t\t|| (parseInt(row.FreeManAge) < parseInt(age) && sex == \"2\" && ageKind == \"岁\")) {\r\n");
      out.write("\t\t\t\tvar obj = {\r\n");
      out.write("\t\t\t\t\t\tpubCost : row.price\r\n");
      out.write("\t\t\t\t};\r\n");
      out.write("\t\t\t\tgrid.updateRow(row, obj);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t} \r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 作废挂号\r\n");
      out.write("\tfunction cancelRegister(e) {\r\n");
      out.write("\t\tvar currentRow = grid4.getSelected();\r\n");
      out.write("\t\tif(currentRow.length <= 0) {  \r\n");
      out.write("\t\t\ttop.mini.alert(\"请选择一条挂号信息！\");\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t} else if(currentRow.validFlag == \"否\") {\r\n");
      out.write("\t\t\ttop.mini.alert(\"该号已经作废，不允许继续操作！\");\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t} else {\r\n");
      out.write("\t\t\ttop.mini.confirm(\"确定作废患者【\"+ currentRow.patientName +\"】 的挂号信息\", ' 提示 ', function(o) {\r\n");
      out.write("\t\t\t\tif (o == \"ok\") {\r\n");
      out.write("\t\t\t\t\tgetPayInfo(currentRow);\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 获取支付信息\r\n");
      out.write("\tfunction getPayInfo(currentRow) {\r\n");
      out.write("\t\tif(!currentRow.tag.receiptId) {\r\n");
      out.write("\t\t\ttop.mini.alert(\"未获取到收据ID\");\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar data = {\r\n");
      out.write("\t\t\tregisterId : currentRow.registerId,\r\n");
      out.write("\t\t\treceiptId : currentRow.tag.receiptId\r\n");
      out.write("\t\t};\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/medical/outpatient/opExpRegister/getPayInfo.do\";\r\n");
      out.write("\t\t$.post(url, data, function (r) {\r\n");
      out.write("\t\t\tif(r.totCost == 0) {// 退费金额等于0时，不弹框直接作废\r\n");
      out.write("\t\t\t\tvar data2 = {\r\n");
      out.write("\t\t\t\t\tregisterId : currentRow.registerId,\r\n");
      out.write("        \t\t\treceiptId : currentRow.tag.receiptId,\r\n");
      out.write("        \t\t\tpaymentList : []\r\n");
      out.write("\t\t\t\t};\r\n");
      out.write("\t\t\t\tdoSave(data2);\r\n");
      out.write("\t\t\t} else {\r\n");
      out.write("// \t\t\t\tr.tag.pubCost = r.pubCost;\r\n");
      out.write("// \t\t\t\tr.tag.ownCost = r.ownCost;\r\n");
      out.write("\t\t\t\tpayInfoView(currentRow , r);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 执行挂号作废\r\n");
      out.write("\tfunction doSave(e) {\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/medical/outpatient/opExpRegister/cancelRegister.do\";\r\n");
      out.write("\t\t$.post(url, e, function (r) {\r\n");
      out.write("\t\t\tif(r == \"ok\") {\r\n");
      out.write("\t\t\t\tmini.showTips({content:\"作废成功\",state:\"success\",x:\"center\",y:\"center\",timeout:3000});\r\n");
      out.write("\t\t\t\tgrid4.load();\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t} else {\r\n");
      out.write("\t\t\t\ttop.mini.alert(r);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 作废挂号时弹出支付方式选择窗口\r\n");
      out.write("\tfunction payInfoView(row , data) { \r\n");
      out.write("\t\tmini.open({\r\n");
      out.write("\t        url: \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/cancelConfirm.do\",\r\n");
      out.write("\t        title: \"选择支付方式\", \r\n");
      out.write("\t        width: 700, \r\n");
      out.write("\t        height: 500,\r\n");
      out.write("\t        onload : function(r) {\r\n");
      out.write("\t        \tvar iframe = this.getIFrameEl();\r\n");
      out.write("\t    \t\tiframe.contentWindow.setData(data);\r\n");
      out.write("\t        },\r\n");
      out.write("\t        ondestroy: function (r) {\r\n");
      out.write("\t        \tif (r.type == \"ok\") {\r\n");
      out.write("\t        \t\tvar data2 = {\r\n");
      out.write("\t        \t\t\tregisterId : row.registerId,\r\n");
      out.write("\t        \t\t\treceiptId : row.tag.receiptId,\r\n");
      out.write("\t        \t\t\tpaymentList : mini.encode(r.paymentList)\r\n");
      out.write("\t        \t\t};\r\n");
      out.write("\t        \t\tdoSave(data2);// 执行挂号作废\r\n");
      out.write("\t        \t}\r\n");
      out.write("\t    \t}\r\n");
      out.write("\t    }); \r\n");
      out.write("\t} \r\n");
      out.write("\t\r\n");
      out.write("\t// 购买病历本\r\n");
      out.write("\tfunction buyBook() { \r\n");
      out.write("\t\ttop.mini.alert(\"购买病历本\");\r\n");
      out.write("\t\treturn;\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 格式时间\r\n");
      out.write("\tfunction formatTime(time,type) {\r\n");
      out.write("\t\tvar date = new Date(time);  \t//就诊时间\r\n");
      out.write("\t\tvar formatdate;\r\n");
      out.write("\t\tswitch(type){\r\n");
      out.write("\t\t\tcase 1:\r\n");
      out.write("\t\t\t\tformatdate = date.getFullYear()+'-'+(date.getMonth()+1)+'-'+date.getDate()+\"   \"\r\n");
      out.write("\t\t\t\t+date.getHours()+\":\"+date.getMinutes()+\":\"+date.getSeconds(); //格式时间\r\n");
      out.write("\t\t\t\tbreak;\r\n");
      out.write("\t\t\tcase 2:\r\n");
      out.write("\t\t\t\tformatdate = date.getFullYear()+'-'+(date.getMonth()+1)+'-'+date.getDate(); //格式时间\r\n");
      out.write("\t\t\t\tif(6<=date.getHours() && date.getHours()<11){\r\n");
      out.write("\t\t\t\t\tformatdate+=\"     上午\"\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tif(11<=date.getHours() && date.getHours()<14){\r\n");
      out.write("\t\t\t\t\tformatdate+=\"     中午\"\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tif(14<=date.getHours() && date.getHours()<17){\r\n");
      out.write("\t\t\t\t\tformatdate+=\"     下午\"\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tbreak;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\treturn formatdate;\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 补打条码\r\n");
      out.write("\tfunction barCode() {\r\n");
      out.write("\t\t//获取选中的行数据\r\n");
      out.write("\t\tvar  row = grid4.getSelected();\r\n");
      out.write("\t\tReport.LoadFromURL(\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/report/template/registerReCode.grf?t=\"+new Date().getTime());//加载报表\r\n");
      out.write("\t\tReport.PrepareLoadData();\r\n");
      out.write("\t\tReport.ParameterByName(\"reCode\").AsString = row.patientId;\t\r\n");
      out.write("// \t\tReport.Print(true);\t\r\n");
      out.write("\t\tReport.PrintPreview(true);// 打印预览\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\t// 执行打印\r\n");
      out.write("\tfunction execPrint(e){\r\n");
      out.write("\t\tvar json;\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t$.ajax({\r\n");
      out.write("\t\t\ttype:\"post\",\r\n");
      out.write("\t\t\turl:\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/printRegisteredInvoice.do\",\r\n");
      out.write("\t\t\tdata:{\r\n");
      out.write("\t\t\t\tregisterId : e\r\n");
      out.write("\t\t\t},\r\n");
      out.write("\t\t\tdataType:\"json\",\r\n");
      out.write("\t\t\tasync: false,\r\n");
      out.write("\t\t\tsuccess: function(data){\r\n");
      out.write("\t\t\t\tjson = data;\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tReport.LoadFromURL(\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/report/template/registeredInvoice.grf?t=\"+new Date().getTime());//加载报表\r\n");
      out.write("\t\t\t\tReport.PrepareLoadData();\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"registerTime\").AsString = json.registerTime;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"patientId\").AsString = json.patientId;\r\n");
      out.write("\t\t\t \tReport.ParameterByName(\"appointmentID\").AsString = json.appointmentID;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"age\").AsString = json.age;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"num\").AsString = !(json.num) ? \"\" : json.num;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"dailySerialId\").AsString = json.dailySerialId;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"patientName\").AsString = json.patientName;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"place\").AsString = !(json.place) ? \"\" : json.place;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"registerDept\").AsString = json.registerDept;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"registerTime\").AsString = json.registerTime;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"reglevel\").AsString = json.reglevel;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"staff\").AsString = json.staff;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"sex\").AsString = json.sex;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"staff\").AsString = json.staff;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"time\").AsString = json.time;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"createTime\").AsString = json.createTime;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"price1\").AsString = json.price1;\r\n");
      out.write("\t\t\t\tReport.ParameterByName(\"price2\").AsString = json.price2; \r\n");
      out.write("\t\t\t\t\r\n");
      out.write("// \t\t\t\tReport.Print(true);\r\n");
      out.write("\t\t\t\tReport.PrintPreview(true);// 打印预览\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 补打发票\r\n");
      out.write("\tfunction printInvoice() {\r\n");
      out.write("\t\tvar  row = grid4.getSelected();\r\n");
      out.write("\t\tvar message = \"确认补打患者[\" +row.patientName+\"]的挂号收据？\\n请注意：补打时，发票不跳号 \";\r\n");
      out.write("\t\tmini.confirm(message,\"请选择！\",\r\n");
      out.write("\t\t\tfunction(action) {\r\n");
      out.write("\t\t\t\tif(action == \"ok\") {\r\n");
      out.write("\t\t\t\t\texecPrint(row.registerId);\r\n");
      out.write("\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t//发票跳号\r\n");
      out.write("\tfunction invoiceJumpNumber(row) {\r\n");
      out.write("\t\t$.ajax({\r\n");
      out.write("\t\t\ttype:\"post\",\r\n");
      out.write("\t\t\turl:\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/invoiceJumpNumber.do\",\r\n");
      out.write("\t\t\tdata:{\r\n");
      out.write("\t\t\t\tregisterId:row.registerId,\r\n");
      out.write("\t\t\t\treceiptNo:row.tag.receiptNo\r\n");
      out.write("\t\t\t},\r\n");
      out.write("\t\t\tdataType:\"json\",\r\n");
      out.write("\t\t\tasync: false\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\r\n");
      out.write("\t// 重打发票\r\n");
      out.write("\tfunction rePrintInvoice() {\r\n");
      out.write("\t\tvar  row = grid4.getSelected();\r\n");
      out.write("\t\tvar message = \"确认重打患者[\" +row.patientName+\"]的挂号收据？\\n请注意：重打时，发票跳号！！！！！！！ \";\r\n");
      out.write("\t\tmini.confirm(message,\"请选择！\",\r\n");
      out.write("\t\t\tfunction(action) {\r\n");
      out.write("\t\t\t\tif(action == \"ok\") {\r\n");
      out.write("\t\t\t\t\tinvoiceJumpNumber(row);\t//发票跳号\r\n");
      out.write("\t\t\t\t\tgrid4.reload();\t\t\t//必须刷新datagrid，否则下次操作同一条数据时会因为receiptNo没有刷新出错\r\n");
      out.write("// \t\t\t\t\trow = grid4.getSelected();\r\n");
      out.write("\t\t\t\t \texecPrint(row.registerId); \t\t//打印发票\r\n");
      out.write("\t\t\t\t} else {\r\n");
      out.write("\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 实际作废挂号\r\n");
      out.write("\tfunction cancelReg(data) {\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/cancelRegister.do\";\r\n");
      out.write("\t\tvar data = {\r\n");
      out.write("\t\t\t\tdata : mini.encode(currentRow)\r\n");
      out.write("\t\t};\r\n");
      out.write("\t\tvar fn = function(r) {\r\n");
      out.write("\t\t\tif(r == \"ok\") {\r\n");
      out.write("\t\t\t\ttop.mini.alert(\"已作废\");\r\n");
      out.write("\t\t\t} else {\r\n");
      out.write("\t\t\t\ttop.mini.alert(r, \"提示\");\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t$.post(url, data, fn);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// tab切换的时候刷新\r\n");
      out.write("\tfunction onactivechanged(e) {\r\n");
      out.write("\t\tgrid4.load();\r\n");
      out.write("\t\tgrid3.load({\r\n");
      out.write("\t\t\tseeDate: mini.formatDate(new Date(), \"yyyy-MM-dd\"),\r\n");
      out.write("\t\t\tcurrentHour: mini.formatDate(new Date(), \"H\")\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tvar sexType = [{id:\"1\",text:\"男\"}, {id:\"2\",text:\"女\"}];\r\n");
      out.write("\t\r\n");
      out.write("\t// 当切换当前科室的时候执行\r\n");
      out.write("\tfunction query() {\r\n");
      out.write("\t\tgrid3.load({\r\n");
      out.write("\t\t\tseeDate: mini.formatDate(new Date(), \"yyyy-MM-dd\"),\r\n");
      out.write("\t\t\tcurrentHour: mini.formatDate(new Date(), \"H\")\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tfunction toJson(str) {\r\n");
      out.write("        return eval('(' + str + ')');\r\n");
      out.write("    }\r\n");
      out.write("\t\r\n");
      out.write("\t// 去空格\r\n");
      out.write("\tfunction trim(str){\r\n");
      out.write("\t\treturn str.replace(/(^\\s*)|(\\s*$)/g, \"\");\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t// 身份证读卡\r\n");
      out.write("\tfunction readCard() {\r\n");
      out.write("\t\t// 加载遮罩\r\n");
      out.write("\t\tmini.mask({\r\n");
      out.write("                    el: document.body,\r\n");
      out.write("                    cls: 'mini-mask-loading',\r\n");
      out.write("                    html: '加载中...'\r\n");
      out.write("                }); \r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar result = CertCtl.readCert();\r\n");
      out.write("\t\tvar resultObj = toJson(result);\r\n");
      out.write("\t\t// 如果成功获取数据\r\n");
      out.write("\t\tif (resultObj.resultFlag == 0) {\r\n");
      out.write("\t\t\tvar name = resultObj.resultContent.partyName;\r\n");
      out.write("\t\t\tvar sex = resultObj.resultContent.gender == \"1\" ? \"1\" : \"2\";\r\n");
      out.write("\t\t\tvar idNo = resultObj.resultContent.certNumber;\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t// 姓名，性别，证件类型，证件号设值\r\n");
      out.write("\t\t\tpatientName.setValue(name);\r\n");
      out.write("\t\t\tsexCode.setValue(sex);\r\n");
      out.write("\t\t\tidnetifierTypeId.setValue(\"01\");\r\n");
      out.write("\t\t\tidnetifierNo.setValue(idNo);\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t// 根据身份证号码计算出生日期和年龄\r\n");
      out.write("\t\t\tonIDCardValidation();\r\n");
      out.write("\t\t\tsexCode.hidePopup();\r\n");
      out.write("\t\t\tpatientMedicaltypeId.hidePopup();\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t// 根据身份证号码检索历史患者信息\r\n");
      out.write("\t\t\tsearchByKey({idnetifierNo : idNo});\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t// 取消遮罩\r\n");
      out.write("\t    \tmini.unmask();\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t} else {\r\n");
      out.write("\t\t\tmini.unmask();\r\n");
      out.write("\t\t\treturn;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t// 穿透模式读卡-cgi\r\n");
      out.write("\t\t/*$.ajax({\r\n");
      out.write("\t\t\turl: \"http://localhost:28000/echo.cgi\",\r\n");
      out.write("\t\t\ttype:\"post\",\r\n");
      out.write("\t\t\tdataType:\"jsonp\",\r\n");
      out.write("\t\t\tjsonpCallback:\"callback\",\r\n");
      out.write("\t\t\tsuccess: function(r) {debugger;\r\n");
      out.write("\t\t\t\t//alert(JSON.stringify(r));\r\n");
      out.write("\t\t\t\tvar card = r.card_info.split(\";;\");\r\n");
      out.write("\t\t\t\tif (card.length == 1) {\r\n");
      out.write("\t\t\t\t\tform1.clear();\r\n");
      out.write("\t\t\t\t\treturn;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tvar birthDate = trim(card[3]);\r\n");
      out.write("\t\t\t\tvar birthyear =  birthDate.substring(0,birthDate.indexOf(\"年\"));\r\n");
      out.write("\t\t\t\tvar year = new Date().getFullYear();\r\n");
      out.write("\t\t\t\tvar ageNum = year-birthyear;\r\n");
      out.write("\t\t\t\tvar data = {\r\n");
      out.write("\t\t\t\t\tpatientName:trim(card[0]),\r\n");
      out.write("\t\t\t\t\tsexCode:trim(card[1]),\r\n");
      out.write("\t\t\t\t\tbirthDate:birthDate,\r\n");
      out.write("\t\t\t\t\tidnetifierNo:trim(card[4]),\r\n");
      out.write("\t\t\t\t\tpresentAddress:trim(card[5]),\r\n");
      out.write("\t\t\t\t\tidnetifierTypeId:\"01\",\r\n");
      out.write("\t\t\t\t\tageNum:ageNum,\r\n");
      out.write("\t\t\t\t\tageType:\"1\"\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tform1.setData(data);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});*/\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tvar num =2 ;\t\r\n");
      out.write("\t// 键盘监听事件(挂号 F4)\r\n");
      out.write("\tdocument.onkeydown=function(event) {\r\n");
      out.write("         var e = event || window.event || arguments.callee.caller.arguments[0];\r\n");
      out.write("         if(e && e.keyCode == 115){  \r\n");
      out.write("        \t registerValidation();\r\n");
      out.write("         }\r\n");
      out.write("         if(e && e.keyCode == 113){\r\n");
      out.write("        \t switch(num)\r\n");
      out.write("\t\t\t\t{\r\n");
      out.write("\t\t\t\tcase 1:\r\n");
      out.write("\t\t\t\t\tdocument.getElementById('text01').innerText = '手机号:';\r\n");
      out.write("\t\t\t\t\tnum = 2 ;\r\n");
      out.write("\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\tcase 2:\r\n");
      out.write("\t\t\t\t\tdocument.getElementById('text01').innerText = '姓　名:';\r\n");
      out.write("\t\t\t\t\tnum = 3 ;\r\n");
      out.write("\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\tcase 3:\r\n");
      out.write("\t\t\t\t\tdocument.getElementById('text01').innerText = '证件号:';\r\n");
      out.write("\t\t\t\t\tnum = 4 ;\r\n");
      out.write("\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\tcase 4:\r\n");
      out.write("\t\t\t\t\tdocument.getElementById('text01').innerText = '唯一号:';\r\n");
      out.write("\t\t\t\t\tnum = 5 ;\r\n");
      out.write("\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\tcase 5:\r\n");
      out.write("\t\t\t\t\tdocument.getElementById('text01').innerText = '员工号:';\r\n");
      out.write("\t\t\t\t\tnum = 6 ;\r\n");
      out.write("\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\tcase 6:\r\n");
      out.write("\t\t\t\t\tdocument.getElementById('text01').innerText = '医疗证号:';\r\n");
      out.write("\t\t\t\t\tnum = 1 ;\r\n");
      out.write("\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("         }\r\n");
      out.write("         \r\n");
      out.write("        var row = grid5.getSelected();\r\n");
      out.write(" \t\tif (event.keyCode == 13) {// 回车键  \r\n");
      out.write(" \t\t\tif(!row) {\r\n");
      out.write(" \t\t\t\treturn;\r\n");
      out.write(" \t\t\t} else {\r\n");
      out.write(" \t\t\t\tsetPatient();\r\n");
      out.write(" \t\t\t}\r\n");
      out.write(" \t\t}\r\n");
      out.write(" \t\t\r\n");
      out.write(" \t\tif (event.keyCode == 27) {// Esc键\r\n");
      out.write("\t\t\twin.hide();\r\n");
      out.write(" \t\t\twin2.hide();\r\n");
      out.write("\t\t}\r\n");
      out.write("     };\r\n");
      out.write("     \r\n");
      out.write("  \t// 双击或滚轮切换检索条件\r\n");
      out.write(" \tfunction changeCondition() {\r\n");
      out.write(" \t\tswitch(num)\r\n");
      out.write(" \t\t{\r\n");
      out.write(" \t\tcase 1:\r\n");
      out.write("\t\t\tdocument.getElementById('text01').innerText = '手机号:';\r\n");
      out.write("\t\t\tnum = 2 ;\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 2:\r\n");
      out.write("\t\t\tdocument.getElementById('text01').innerText = '姓　名:';\r\n");
      out.write("\t\t\tnum = 3 ;\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 3:\r\n");
      out.write("\t\t\tdocument.getElementById('text01').innerText = '证件号:';\r\n");
      out.write("\t\t\tnum = 4 ;\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 4:\r\n");
      out.write("\t\t\tdocument.getElementById('text01').innerText = '唯一号:';\r\n");
      out.write("\t\t\tnum = 5 ;\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 5:\r\n");
      out.write("\t\t\tdocument.getElementById('text01').innerText = '员工号:';\r\n");
      out.write("\t\t\tnum = 6 ;\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 6:\r\n");
      out.write("\t\t\tdocument.getElementById('text01').innerText = '医疗证号:';\r\n");
      out.write("\t\t\tnum = 1 ;\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write(" \t\t}\r\n");
      out.write(" \t}\r\n");
      out.write("  \t\r\n");
      out.write(" \t// 查询并回填患者信息\r\n");
      out.write("\tfunction searchPatient(e) {\r\n");
      out.write("\t\tvar key = mini.get(\"key\").getValue();\r\n");
      out.write("\t\tif(!key) return;\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tswitch(num)\r\n");
      out.write("\t\t{\r\n");
      out.write("\t\tcase 1:\r\n");
      out.write("\t\t\tsearchByKey({medicalCertificateNo : key});\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 2:\r\n");
      out.write("\t\t\tsearchByKey({phone : key});\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 3:\r\n");
      out.write("\t\t\tsearchByKey({patientName : key});\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 4:\r\n");
      out.write("\t\t\tsearchByKey({idnetifierNo : key});\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 5:\r\n");
      out.write("\t\t\tsearchByKey({patientId : key});\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\tcase 6:\r\n");
      out.write("\t\t\tsearchByCardNo(key);\r\n");
      out.write("\t\t\tbreak;\r\n");
      out.write("\t\t}\r\n");
      out.write(" \t}\r\n");
      out.write(" \t\r\n");
      out.write("\t// 根据电话,唯一号，等查询并回填患者信息\r\n");
      out.write("\tfunction searchByKey(e) {\r\n");
      out.write("\t\tvar key = mini.get(\"key\").getValue();\r\n");
      out.write("\t\tvar text = $(\"#text01\").text();\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/medical/common/patient/getByNameOrPhone.do\";\r\n");
      out.write("\t\t$.post(url, e , function(r) {\r\n");
      out.write("\t\t\tvar count = r.length;\r\n");
      out.write("\t\t\tif(count == 0){\r\n");
      out.write("// \t\t\t\tmini.alert(\"没有找到 \"+text+\" \"+key+\" 的信息\");\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tif(count == 1){// 如果根key只查到一条信息，直接回填\r\n");
      out.write("\t\t\t\tr[0].presentAddress = r[0].address;\r\n");
      out.write("\t\t\t\tvar ageNumValue = r[0].age.substring(0, r[0].age.length-1);\r\n");
      out.write("\t\t    \tvar ageTypeValue = r[0].age.substring(r[0].age.length-1);\r\n");
      out.write("\t\t    \tr[0].ageNum = ageNumValue;\r\n");
      out.write("\t\t    \tif (ageTypeValue == \"Y\") {\r\n");
      out.write("\t\t    \t\tr[0].ageType = \"1\";\r\n");
      out.write("\t\t    \t} else if (ageTypeValue == \"M\") {\r\n");
      out.write("\t\t    \t\tr[0].ageType = \"2\";\r\n");
      out.write("\t\t    \t} else if (ageTypeValue == \"D\") {\r\n");
      out.write("\t\t    \t\tr[0].ageType = \"3\";\r\n");
      out.write("\t\t    \t} else if (ageTypeValue == \"H\") {\r\n");
      out.write("\t\t    \t\tr[0].ageType = \"4\";\r\n");
      out.write("\t\t    \t}\t\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t    \tform1.clear();\r\n");
      out.write("\t\t\t\tform1.setData(r[0]);\r\n");
      out.write("\t\t\t\tallowUpdatePatient(false);\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tif(count > 1){// 如果根据key查到多条信息，弹出供选择\r\n");
      out.write("\t\t\t\twin.setTitle(\"患者信息\");\r\n");
      out.write("\t\t\t\twin.show();\r\n");
      out.write("\t\t\t\tgrid5.loadData(r);\r\n");
      out.write("\t\t\t\tgrid5.focus();\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write("\t}\r\n");
      out.write(" \t\r\n");
      out.write(" \t// 根据员工卡号检索\r\n");
      out.write(" \tfunction searchByCardNo(e) {\r\n");
      out.write(" \t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/maintenance/patientCard/getByKeys.do\";\r\n");
      out.write(" \t\tvar data = {\r\n");
      out.write(" \t\t\tcardNo : e,\r\n");
      out.write(" \t\t\tstatus : \"1\",\r\n");
      out.write(" \t\t\tcardType : \"2\"\r\n");
      out.write(" \t\t};\r\n");
      out.write(" \t\t$.post(url, data , function(r) {\r\n");
      out.write("\t\t\tvar count = r.length;\r\n");
      out.write("\t\t\tif(count == 0) {\r\n");
      out.write("\t\t\t\tmini.alert(\"没有找到员工卡号为  \"+e+\" 的信息\");\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tsearchByKey({patientId : r[0].patientId});\r\n");
      out.write("\t\t});\r\n");
      out.write(" \t}\r\n");
      out.write(" \t\r\n");
      out.write(" \t// 双击患者信息弹框，设置患者表单信息\r\n");
      out.write("\tfunction setPatient(e) {\r\n");
      out.write("// \t\tvar patientInfo = e.row;\r\n");
      out.write("\t\tvar patientInfo = grid5.getSelected();\r\n");
      out.write("\t\tpatientInfo.presentAddress = patientInfo.address;\r\n");
      out.write("\t\tvar ageNumValue = patientInfo.age.substring(0, patientInfo.age.length-1);\r\n");
      out.write("    \tvar ageTypeValue = patientInfo.age.substring(patientInfo.age.length-1);\r\n");
      out.write("    \tpatientInfo.ageNum = ageNumValue;\r\n");
      out.write("    \tif (ageTypeValue == \"Y\") {\r\n");
      out.write("    \t\tpatientInfo.ageType = \"1\";\r\n");
      out.write("    \t} else if (ageTypeValue == \"M\") {\r\n");
      out.write("    \t\tpatientInfo.ageType = \"2\";\r\n");
      out.write("    \t} else if (ageTypeValue == \"D\") {\r\n");
      out.write("    \t\tpatientInfo.ageType = \"3\";\r\n");
      out.write("    \t} else if (ageTypeValue == \"H\") {\r\n");
      out.write("    \t\tpatientInfo.ageType = \"4\";\r\n");
      out.write("    \t}\t\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tform1.setData(patientInfo);\r\n");
      out.write("\t\twin.hide();\r\n");
      out.write("\t\tallowUpdatePatient(false);\r\n");
      out.write("\t}\r\n");
      out.write(" \t\r\n");
      out.write(" \t// 获取发票号码（不领用，不跳号）\r\n");
      out.write(" \tfunction getInvoiceNo() {\r\n");
      out.write("\t\t$.ajax({\r\n");
      out.write("\t\t\turl:\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/maintenance/invoice/getInvoiceNoNoUpdate.do\",\r\n");
      out.write("\t\t\ttype:\"post\",\r\n");
      out.write("\t\t\tdata:{invoiceType : \"R\"},\r\n");
      out.write("\t\t\tsuccess:function(r) {\r\n");
      out.write("\t\t\t\tif(r.state == \"ok\") {\r\n");
      out.write("\t \t\t\t\tmini.alert(r.invoiceNo);\r\n");
      out.write("\t \t\t\t} else {\r\n");
      out.write("\t \t\t\t\tmini.alert(r.msg);\r\n");
      out.write("\t \t\t\t}\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write(" \t}\r\n");
      out.write(" \t\r\n");
      out.write(" \t// 健康卡读卡\r\n");
      out.write(" \tfunction patientCardReading() {\r\n");
      out.write(" \t\twin2.show();\r\n");
      out.write(" \t\tmini.get(\"patientCardNo\").focus();\r\n");
      out.write(" \t}\r\n");
      out.write(" \t\r\n");
      out.write(" \t// 根据健康卡号查询患者信息\r\n");
      out.write(" \tfunction getByPatientCard() {\r\n");
      out.write(" \t\tvar patientCardNo = mini.get(\"patientCardNo\").getValue();\r\n");
      out.write(" \t\tif(!patientCardNo || patientCardNo.trim() == \"\") {\r\n");
      out.write(" \t\t\treturn;\r\n");
      out.write(" \t\t}\r\n");
      out.write(" \t\t\r\n");
      out.write(" \t\tvar url = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/medical/common/patient/getByCardsId.do\";\r\n");
      out.write(" \t\tvar data = {cardsId: patientCardNo};\r\n");
      out.write(" \t\t$.post(url, data , function(r) {\r\n");
      out.write(" \t\t\tif(!r) {\r\n");
      out.write("\t\t\t\tmini.alert(\"没有找到患者信息\");\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t} else {\r\n");
      out.write("\t\t\t\tmini.get(\"presentAddress\").setValue(r.address);\r\n");
      out.write("\t\t\t\tvar ageNumValue = r.age.substring(0, r.age.length-1);\r\n");
      out.write("\t\t    \tvar ageTypeValue = r.age.substring(r.age.length-1);\r\n");
      out.write("\t\t    \tr.ageNum = ageNumValue;\r\n");
      out.write("\t\t    \tif (ageTypeValue == \"Y\") {\r\n");
      out.write("\t\t    \t\tr.ageType = \"1\";\r\n");
      out.write("\t\t    \t} else if (ageTypeValue == \"M\") {\r\n");
      out.write("\t\t    \t\tr.ageType = \"2\";\r\n");
      out.write("\t\t    \t} else if (ageTypeValue == \"D\") {\r\n");
      out.write("\t\t    \t\tr.ageType = \"3\";\r\n");
      out.write("\t\t    \t} else if (ageTypeValue == \"H\") {\r\n");
      out.write("\t\t    \t\tr.ageType = \"4\";\r\n");
      out.write("\t\t    \t}\t\r\n");
      out.write("\t\t    \t\r\n");
      out.write("\t\t    \tform1.setData(r);\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\twin2.hide();\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t});\r\n");
      out.write(" \t}\r\n");
      out.write(" \t\r\n");
      out.write(" \t// 按回车键切换输入框\r\n");
      out.write("\tfunction changeTab(tabName) {\r\n");
      out.write("\t\tvar tabControl = mini.get(tabName);\r\n");
      out.write("\t\ttabControl.focus();\r\n");
      out.write("\t\tif (tabControl && tabControl.popup) {\r\n");
      out.write("\t\t\ttabControl.showPopup();\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write(" \t\r\n");
      out.write("\t// 科室变化时\r\n");
      out.write("\ttop.on(\"EVENT_ORG_CHANGED\", query);\r\n");
      out.write("\t$(window).unload(function() {\r\n");
      out.write("\t\ttop.un(\"EVENT_ORG_CHANGED\", query);\r\n");
      out.write("\t});\r\n");
      out.write("\t\r\n");
      out.write("\t\r\n");
      out.write("\tfunction show() {\r\n");
      out.write("\t\t$(\".hideBegin\").show();\r\n");
      out.write("\t}\r\n");
      out.write("</script>\r\n");
      out.write("</head>\r\n");
      out.write("<body>\r\n");
      out.write("\t<div class=\"mini-splitter hideBegin\" style=\"display:none;width: 100%; height: 100%;\"\r\n");
      out.write("\t\tallowResize=\"false\"  borderStyle=\"border-top:0;\">\r\n");
      out.write("\t\t<div size=\"730px;\" showCollapseButton=\"false\">\r\n");
      out.write("\t\t\t<div class=\"mini-toolbar\"\r\n");
      out.write("\t\t\t\tborderStyle=\"border-top:0;border-right:0;border-left:0;border-bottom:1;\">\r\n");
      out.write("\t\t\t\t<span id=\"text01\" style=\"font-size: 14px; color: #006aad; font-weight: bold;\" ondblclick=\"changeCondition()\" onmousewheel=\"changeCondition()\" \r\n");
      out.write("\t\t\t\t\ttitle=\"手机号、姓名、证件号、唯一号、住院号、医疗证号\">手机号:</span> \r\n");
      out.write("\t\t\t\t<input id=\"key\" class=\"mini-textbox\" emptyText=\"按F2切换检索条件\" onenter=\"searchPatient\"/>&nbsp;\r\n");
      out.write("\t\t\t\t<span style=\"font-size: 14px; color: #006aad; font-weight: bold;\">预约号:</span>\r\n");
      out.write("\t\t\t\t<input id=\"appointmentNo\" name=\"appointmentNo\" class=\"mini-textbox\" emptyText=\"输入预约号 回车\" onenter=\"setAppointment\"/>&nbsp;\r\n");
      out.write("\t\t\t\t<span style=\"font-size: 14px; color: #ff3d00; font-weight: bold;\">下一票号:</span>\r\n");
      out.write("\t\t\t\t<span style=\"font-size: 14px; color: #ff3d00; font-weight: bold;\">\r\n");
      out.write("\t\t\t\t\t");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${invoice.invoiceNo}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write(" \r\n");
      out.write("\t\t\t\t\t");
      out.write("\r\n");
      out.write("\t\t\t\t</span>\r\n");
      out.write("\t\t\t\t<!-- <a class=\"mini-button\" iconCls=\"\" onclick=\"getInvoiceNo\">$取发票号测试$</a> -->\r\n");
      out.write("\t\t\t</div>\r\n");
      out.write("\t\t\t<div id=\"parentForm\" class=\"mini-toolbar\"\r\n");
      out.write("\t\t\t\tborderStyle=\"border-top:0;border-right:0;border-left:0;border-bottom:1;\">\r\n");
      out.write("\t\t\t\t<input id=\"receiptNo\" name=\"receiptNo\" class=\"mini-hidden\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${invoice.invoiceNo}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("\"/>\r\n");
      out.write("\t\t\t\t<fieldset style=\"\">\r\n");
      out.write("\t\t\t\t\t<legend>\r\n");
      out.write("\t\t\t\t\t\t<span>患者信息</span>\r\n");
      out.write("\t\t\t\t\t</legend>\r\n");
      out.write("\t\t\t\t\t<div id=\"form1\" class=\"fieldset-body\">\r\n");
      out.write("\t\t\t\t\t\t<input id=\"patientId\" name=\"patientId\" class=\"mini-hidden\"/>\r\n");
      out.write("\t\t\t\t\t\t<input id=\"name\" name=\"name\" class=\"mini-hidden\"/>\r\n");
      out.write("\t\t\t\t\t\t<input id=\"registerClass\" name=\"registerClass\" class=\"mini-hidden\" value=\"0\"/>\r\n");
      out.write("\t\t\t\t\t\t<input id=\"appointmentId\" name=\"appointmentId\" class=\"mini-hidden\" value=\"-1\"/>\r\n");
      out.write("\t\t\t\t\t\t<table cellspacing=\"0\" style=\"width: 100%; height: 100%;\">\r\n");
      out.write("\t\t\t\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label required\"  style=\"width: 80px;\">姓名：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td style=\"width: 50px;\">\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input id=\"patientName\" name=\"patientName\"class=\"mini-textbox\" onenter=\"havePatient\" required=\"true\" onvalidation=\"onCnEnValidation\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label required\" style=\"width: 80px;\">出生日期：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input id=\"birthDate\" name=\"birthDate\" class=\"mini-datepicker\" required=\"true\" onenter=\"getAge\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label required\"  style=\"width: 80px;\">性别：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input id=\"sexCode\" name=\"sexCode\" class=\"mini-combobox\" style=\"width: 60px;\" data=\"sexType\" required=\"true\" onenter=\"changeTab('idnetifierTypeId')\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label\">证件类型：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input id=\"idnetifierTypeId\" name=\"idnetifierTypeId\" class=\"mini-combobox\" showNullItem=\"true\" nullItemText=\"---未选择---\" \r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tonenter=\"changeTab('idnetifierNo')\" url=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/platform/system/sysDict/getKVs.do?dictType=BD_IDENTIFIER_TYPE\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label\">证件号：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input id=\"idnetifierNo\" name=\"idnetifierNo\" class=\"mini-textbox\" style=\"width:160px\" onenter=\"onIDCardValidation\" /></td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label\" style=\"width:40px;\">年龄：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input id=\"ageNum\" name=\"ageNum\" class=\"mini-textbox\" style=\"width: 40px;\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input id=\"ageType\" name=\"ageType\" class=\"mini-combobox\" style=\"width: 60px;\" \r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tdata=\"[{id:1,text:'岁'},{id:2,text:'月'},{id:3,text:'天'},{id:4,text:'小时'}]\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label required\">结算类型：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input id=\"patientMedicaltypeId\" name=\"patientMedicaltypeId\" class=\"mini-combobox\" required=\"true\" valueFromSelect=\"true\" \r\n");
      out.write("\t\t\t\t\t\t\t\t\t\turl=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/common/medicalType/getChildKVs.do\" onvaluechanged=\"changeMedicaltype\" onenter=\"changeTab('patientMedicaltypeKindId')\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label required\">结算种类：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input id=\"patientMedicaltypeKindId\" name=\"patientMedicaltypeKindId\" class=\"mini-combobox\" valueFromSelect=\"true\" \r\n");
      out.write("\t\t\t\t\t\t\t\t\t\turl=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/common/medicalTypeKind/getKVs.do?blank=0\" required=\"true\" onbeforeshowpopup=\"\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tonvaluechanged=\"showRegLevelItemList\" onenter=\"changeTab('phone')\"/></td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label\">医疗证号：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input name=\"medicalCertificateNo\" class=\"mini-textbox\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label\">手机号：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td><input id=\"phone\" name=\"phone\" class=\"mini-textbox\" onenter=\"changeTab('presentAddress')\"/></td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label\">现地址：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td colspan=\"2\">\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input id=\"presentAddress\" name=\"presentAddress\" class=\"mini-textbox\" style=\"width:90%;\" onenter=\"changeTab('reglevelId')\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<div id=\"emergencyFlag\" name=\"emergencyFlag\" class=\"mini-checkbox\" text=\"是否加急\" trueValue=\"1\" falseValue=\"0\"></div>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t</table>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t</fieldset>\r\n");
      out.write("\t\t\t\t<fieldset>\r\n");
      out.write("\t\t\t\t\t<legend>\r\n");
      out.write("\t\t\t\t\t\t<span>挂号信息</span>\r\n");
      out.write("\t\t\t\t\t</legend>\r\n");
      out.write("\t\t\t\t\t<div id=\"form2\" class=\"fieldset-body\">\r\n");
      out.write("\t\t\t\t\t\t<input name=\"seeBeginTime\" class=\"mini-hidden\"/>\r\n");
      out.write("\t\t\t\t\t\t<input name=\"seeEndTime\" class=\"mini-hidden\"/>\r\n");
      out.write("\t\t\t\t\t\t<table cellspacing=\"2\" style=\"width: 100%; height: 100%;\">\r\n");
      out.write("\t\t\t\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label required\">挂号级别：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td><input id=\"reglevelId\" name=\"reglevelId\" class=\"mini-combobox\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\turl=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/maintenance/register/regLevel/getKVs.do?validFlag=1\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\tonvaluechanged=\"onRegLevelChanged\" required=\"true\" onenter=\"changeTab('deptId')\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label required\">挂号科室：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td><input id=\"deptId\" name=\"deptId\" class=\"mini-combobox\" allowInput=\"true\" popupwidth=\"200\" \r\n");
      out.write("\t\t\t\t\t\t\t\t\tonvaluechanged=\"deptChanged\" required=\"true\" valueFromSelect=\"true\" onenter=\"changeTab('doctId')\" \r\n");
      out.write("\t\t\t\t\t\t\t\t\t url=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/platform/system/sysOrgRelationShip/getRelationshipKVs.do?departmentRelationshipKind=02&blank=0\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label\">挂号医生：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td><input id=\"doctId\" name=\"doctId\" class=\"mini-combobox\" allowInput=\"true\" popupwidth=\"200\" valueFromSelect=\"true\" \r\n");
      out.write("\t\t\t\t\t\t\t\t\tonvaluechanged=\"doctChanged\" onenter=\"changeTab('scheduleId')\" url=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/platform/system/sysUser/getKVs.do?employeeType=D&blank=1\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label required\">看诊日期：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td colspan=\"3\"><input id=\"scheduleId\" name=\"scheduleId\" onenter=\"changeTab('scheduleTimeId')\" \r\n");
      out.write("\t\t\t\t\t\t\t\t\tonvaluechanged=\"scheduleChanged\" style=\"width: 349px;\" class=\"mini-combobox\" required=\"true\" />\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label\">看诊序号：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td><input id=\"scheduleTimeId\" name=\"scheduleTimeId\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\tclass=\"mini-combobox\" dateFormat=\"yyyy-MM-dd\" textField=\"text\"/></td>\r\n");
      out.write("\t\t\t\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label\">门慢信息：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td colspan=\"3\">\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input name=\"chronicDiseaseId\" style=\"width: 349px;\" class=\"mini-combobox\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\turl=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/platform/system/sysDict/getKVs.do?dictType=BD_DRUGSILIMITMM\" />\r\n");
      out.write("\t\t\t\t\t\t\t\t</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label required\">总金额：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td><input id=\"totalCost\" class=\"mini-textbox\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\tinputStyle=\"font-weight: bolder;color: red;\" allowInput=\"false\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\tvalue=\"0.00\" /> <!-- 记账总金额 --> <input id=\"totalPubCost\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\tclass=\"mini-hidden\" value=\"0.0\"></td>\r\n");
      out.write("\t\t\t\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t\t<tr>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td class=\"form-label\">备注：</td>\r\n");
      out.write("\t\t\t\t\t\t\t\t<td colspan=\"5\"><input name=\"\" class=\"mini-text\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\tstyle=\"width: 570px;\" /></td>\r\n");
      out.write("\t\t\t\t\t\t\t</tr>\r\n");
      out.write("\t\t\t\t\t\t</table>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t</fieldset>\r\n");
      out.write("\t\t\t</div>\r\n");
      out.write("\t\t\t<div class=\"mini-fit\">\r\n");
      out.write("\t\t\t\t<div id=\"grid2\" class=\"mini-datagrid\" showPager=\"false\"\r\n");
      out.write("\t\t\t\t\tborderStyle=\"border:0;\"\r\n");
      out.write("\t\t\t\t\turl=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/getRegLevelItemList.do\"\r\n");
      out.write("\t\t\t\t\tondrawcell=\"ondrawcell2\" style=\"width: 100%; height: 100%;\"\r\n");
      out.write("\t\t\t\t\tallowCellEdit=\"true\" onload=\"calculateCost\" oncellbeginedit=\"oncellbeginedit\">\r\n");
      out.write("\t\t\t\t\t<div property=\"columns\">\r\n");
      out.write("\t\t\t\t\t\t<div type=\"indexcolumn\"></div>\r\n");
      out.write("\t\t\t\t\t\t<div field=\"fixedFlag\" type=\"checkboxcolumn\" trueValue=\"1\" falseValue=\"0\" headerAlign=\"center\" align=\"center\" width=\"30\">选择</div>\r\n");
      out.write("\t\t\t\t\t\t<div field=\"itemFeeType\" type=\"comboboxcolumn\" headerAlign=\"center\" align=\"center\">类别\r\n");
      out.write("\t\t\t\t\t\t\t <input property=\"editor\" class=\"mini-combobox\" url=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/platform/system/sysDict/getKVs.do?dictType=BD_ITEMFEETYPE\"/>\r\n");
      out.write("\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t<div field=\"nondrugName\" headerAlign=\"center\" align=\"center\">名称</div>\r\n");
      out.write("\t\t\t\t\t\t<div field=\"qty\" headerAlign=\"center\" align=\"center\">数量</div>\r\n");
      out.write("\t\t\t\t\t\t<div field=\"totCost\" headerAlign=\"center\" align=\"center\">金额</div>\r\n");
      out.write("\t\t\t\t\t\t<div field=\"pubCost\" headerAlign=\"center\" align=\"center\">记账金额</div>\r\n");
      out.write("\t\t\t\t\t\t<div field=\"reglevelitemlistId\" visible=\"false\" >挂号费对应项目流水号</div>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t</div>\r\n");
      out.write("\t\t\t</div>\r\n");
      out.write("\t\t</div>\r\n");
      out.write("\r\n");
      out.write("\t\t<div showCollapseButton=\"false\">\r\n");
      out.write("\t\t\t<div class=\"mini-toolbar\"\r\n");
      out.write("\t\t\t\tborderStyle=\"border-top:0;border-right:0;border-left:0;border-bottom:1;\">\r\n");
      out.write("\t\t\t\t<a id=\"appointment\" class=\"mini-button\" iconCls=\"\" onclick=\"appointmentView\">选择预约</a> \r\n");
      out.write("\t\t\t\t<!-- <a class=\"mini-button\" iconCls=\"\" onclick=\"railwayReading\">铁路读卡</a>  -->\r\n");
      out.write("\t\t\t\t<a class=\"mini-button\" iconCls=\"\" onclick=\"patientCardReading\">健康卡读卡</a> \r\n");
      out.write("\t\t\t\t<a class=\"mini-button\" iconCls=\"\" onclick=\"readCard\"> 身份证读卡 </a> \r\n");
      out.write("\t\t\t\t<a class=\"mini-button\" iconCls=\"\" onclick=\"registerValidation\"> 挂号(F4) </a> \r\n");
      out.write("\t\t\t\t<a class=\"mini-button\" iconCls=\"\" onclick=\"receiptView\"> 发票累计 </a> \r\n");
      out.write("\t\t\t\t<a class=\"mini-button\" iconCls=\"fa fa-remove\" onclick=\"refresh\">清空</a>\r\n");
      out.write("\t\t\t</div>\r\n");
      out.write("\t\t\t<div class=\"mini-fit\">\r\n");
      out.write("\t\t\t\t<div class=\"mini-tabs\" style=\"width: 100%; height: 100%;\"\r\n");
      out.write("\t\t\t\t\tonactivechanged=\"onactivechanged\">\r\n");
      out.write("\t\t\t\t\t<div title=\"出诊信息\">\r\n");
      out.write("\t\t\t\t\t\t<div id=\"grid3\" class=\"mini-datagrid\" showPager=\"true\" pagesize=\"20\" \r\n");
      out.write("\t\t\t\t\t\t\tstyle=\"width: 100%; height: 100%;\" ondrawcell=\"ondrawcell\"\r\n");
      out.write("\t\t\t\t\t\t\turl=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/schedule/getRegisterSchedule.do\"\r\n");
      out.write("\t\t\t\t\t\t\tonrowdblclick=\"showScheduleInfo\">\r\n");
      out.write("\t\t\t\t\t\t\t<div property=\"columns\">\r\n");
      out.write("\t\t\t\t\t\t\t\t<div type=\"indexcolumn\"></div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"scheduleId\" visible=\"false\">排班ID</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"reged\" visible=\"false\">来人已挂</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"reglevelId\" type=\"comboboxColumn\" headerAlign=\"center\" align=\"center\">挂号级别\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input property=\"editor\" class=\"mini-combobox\" url=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/maintenance/register/regLevel/getKVs.do\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"deptId\" type=\"comboboxColumn\" width=\"150\" headerAlign=\"center\" align=\"center\">挂号科室\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input property=\"editor\" class=\"mini-combobox\" allowInput=\"true\" url=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/platform/system/sysOrg/getKVs.do\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"doctId\" type=\"comboboxColumn\" headerAlign=\"center\" width=\"80\" align=\"center\">医生\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<input property=\"editor\" class=\"mini-combobox\" allowInput=\"true\" url=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/platform/system/sysUser/getKVs.do\"/>\r\n");
      out.write("\t\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.seeTimeName\" headerAlign=\"center\" align=\"center\" width=\"250\">出诊时间</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.unregNum\" headerAlign=\"center\" align=\"center\">剩余限额</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.untelNum\" headerAlign=\"center\" align=\"center\">剩余预约额</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"seeBeginTime\" headerAlign=\"center\" align=\"center\" width=\"150\" dateFormat=\"yyyy-MM-dd HH:mm:ss\">看诊开始时间</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"seeEndTime\" headerAlign=\"center\" align=\"center\" width=\"150\" dateFormat=\"yyyy-MM-dd HH:mm:ss\">看诊结束时间</div>\r\n");
      out.write("\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t<div title=\"挂号信息\">\r\n");
      out.write("\t\t\t\t\t\t<div id=\"grid4\" class=\"mini-datagrid\" showPager=\"true\"\r\n");
      out.write("\t\t\t\t\t\t\tstyle=\"width: 100%; height: 100%;\"\r\n");
      out.write("\t\t\t\t\t\t\turl=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/expense/outpatient/radt/opRegister/getOpRegister.do\"\r\n");
      out.write("\t\t\t\t\t\t\tonrowdblclick=\"showPatientInfo\" contextMenu=\"#contextMenu\">\r\n");
      out.write("\t\t\t\t\t\t\t<div property=\"columns\">\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"dailySerialId\" headerAlign=\"center\" align=\"center\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\twidth=\"50px\">当日号</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"patientId\" headerAlign=\"center\" align=\"center\">唯一号\r\n");
      out.write("\t\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"patientName\" headerAlign=\"center\" align=\"center\">患者姓名\r\n");
      out.write("\t\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.sexName\" headerAlign=\"center\" width=\"50px\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\talign=\"center\">性别</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"age\" headerAlign=\"center\" width=\"50px\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\talign=\"center\">年龄</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.reglevel\" headerAlign=\"center\" align=\"center\">级别\r\n");
      out.write("\t\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.registerDept\" headerAlign=\"center\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\talign=\"center\">科室</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.registerDoct\" headerAlign=\"center\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\talign=\"center\">医生</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"registerTime\" headerAlign=\"center\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\tdateFormat=\"yyyy-MM-dd\" align=\"center\">挂号日期</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.seeDoct\" headerAlign=\"center\" align=\"center\">看诊医生\r\n");
      out.write("\t\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"validFlag\" headerAlign=\"center\" width=\"50px\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\talign=\"center\">有效</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.cost\" headerAlign=\"center\" align=\"center\">金额\r\n");
      out.write("\t\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.receiptNo\" headerAlign=\"center\" align=\"center\">发票号\r\n");
      out.write("\t\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"tag.receiptId\" visible=\"false\">收据ID（隐藏）</div>\r\n");
      out.write("\t\t\t\t\t\t\t\t<div field=\"registerId\" visible=\"false\">门诊登记ID（隐藏）</div>\r\n");
      out.write("\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t</div>\r\n");
      out.write("\t\t\t</div>\r\n");
      out.write("\t\t</div>\r\n");
      out.write("\t</div>\r\n");
      out.write("\t\r\n");
      out.write("\t<!-- win1检索出多条记录 -->\r\n");
      out.write("     <div id=\"win1\" class=\"mini-window\" style=\"display:none;width:50%;height:500px;\">\r\n");
      out.write("\t     <div class=\"mini-fit\">\r\n");
      out.write("\t        <div id=\"grid5\" class=\"mini-datagrid\" style=\"width:100%;height:100%;\"  \r\n");
      out.write("\t        \tallowResize=\"true\" borderStyle=\"border-left:0;border-right:0;\" onrowdblclick=\"setPatient\">\r\n");
      out.write("\t            <div property=\"columns\">\r\n");
      out.write("\t                <div field=\"patientId\" headerAlign=\"center\" align=\"center\">唯一号</div>\r\n");
      out.write("\t                <div field=\"inpatientNo\" headerAlign=\"center\" align=\"center\">住院号</div>\r\n");
      out.write("\t                <div field=\"patientName\" headerAlign=\"center\" align=\"center\">患者姓名</div>    \r\n");
      out.write("\t                <div field=\"sexCode\" type=\"comboboxcolumn\" headerAlign=\"center\" align=\"center\">性别\r\n");
      out.write("\t\t\t\t \t\t<input property=\"editor\" class=\"mini-combobox\" style=\"width:100%;\" data=\"sexType\"/>\r\n");
      out.write("\t\t\t\t \t</div>                                            \r\n");
      out.write("\t                <div field=\"age\" headerAlign=\"center\" align=\"center\">年龄</div>\r\n");
      out.write("\t                <div field=\"idnetifierTypeId\" type=\"comboboxcolumn\" headerAlign=\"center\" align=\"center\">证件类型\r\n");
      out.write("\t\t\t\t \t\t<input property=\"editor\" class=\"mini-combobox\" style=\"width:100%;\" \r\n");
      out.write("\t\t\t\t \t\t\turl=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/platform/system/sysDict/getKVs.do?dictType=BD_IDENTIFIER_TYPE\"/>\r\n");
      out.write("\t\t\t\t \t</div>\r\n");
      out.write("\t                <div field=\"idnetifierNo\" headerAlign=\"center\" align=\"center\" width=\"150\">证件号</div>\r\n");
      out.write("\t                <div field=\"phone\" headerAlign=\"center\" align=\"center\">电话</div>\r\n");
      out.write("\t                <div field=\"address\" headerAlign=\"center\" align=\"center\">现住地址</div> \r\n");
      out.write("\t                <div field=\"deptId\" headerAlign=\"center\" align=\"center\" type=\"comboboxcolumn\">科室\r\n");
      out.write("\t\t\t\t \t\t<input property=\"editor\" class=\"mini-combobox\" style=\"width:100%;\" url=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${ctx}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("/platform/system/sysOrg/getKVs.do?orgType=I\"/>\r\n");
      out.write("\t\t\t\t \t</div> \r\n");
      out.write("\t                <div field=\"admitTime\" headerAlign=\"center\" align=\"center\" dateFormat=\"yyyy-MM-dd HH:mm:ss\">入院时间</div>\r\n");
      out.write("\t            </div>\r\n");
      out.write("\t        </div>\r\n");
      out.write("\t    </div>\r\n");
      out.write("    </div>\r\n");
      out.write("    \r\n");
      out.write("    <!-- 健康卡读卡弹框（临时） -->\r\n");
      out.write("    <div id=\"win2\" class=\"mini-window\" title=\"健康卡号查询\" style=\"display:none;width:200px;height:30px;\">\r\n");
      out.write("    \t<input id=\"patientCardNo\" style=\"width:180px\" class=\"mini-textbox\" onenter=\"getByPatientCard\"/>\r\n");
      out.write("    </div>\r\n");
      out.write("\t\r\n");
      out.write("\t<div style=\"display:block;margin-top:-16\">\r\n");
      out.write("\t\t<script type=\"text/javascript\">\r\n");
      out.write("\t\t\t CreateReport(\"Report\");\r\n");
      out.write("\t\t</script>\r\n");
      out.write("\t</div>\r\n");
      out.write("\t\r\n");
      out.write("\t<object id=\"CertCtl\" name=\"CertCtl\" type=\"application/cert-reader\" width=\"0\" height=\"0\">\r\n");
      out.write("          \t该浏览器不支持身份证阅读器控件！\r\n");
      out.write("    </object>\r\n");
      out.write("\r\n");
      out.write("\t<ul id=\"contextMenu\" class=\"mini-contextmenu\">\r\n");
      out.write("\t\t<!-- <li onclick=\"buyBook\">购病历本</li> -->\r\n");
      out.write("\t\t<li class=\"separator\"></li>\r\n");
      out.write("\t\t<li onclick=\"barCode\">补打条码</li>\r\n");
      out.write("\t\t<li onclick=\"printInvoice\">补打发票</li>\r\n");
      out.write("\t\t<li class=\"separator\"></li>\r\n");
      out.write("\t\t<li onclick=\"rePrintInvoice\">重打发票</li>\r\n");
      out.write("\t\t<li class=\"separator\"></li>\r\n");
      out.write("\t\t<li onclick=\"cancelRegister\">作废挂号</li>\r\n");
      out.write("\t</ul>\r\n");
      out.write("\t<script type=\"text/javascript\">\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tmini.parse();\r\n");
      out.write("\t\tvar key = mini.get(\"key\");\r\n");
      out.write("\t\tkey.focus();\r\n");
      out.write("// \t\tvar invoiceId = mini.get(\"invoiceId\");\r\n");
      out.write("\t\tvar form1 = new mini.Form(\"#form1\");\r\n");
      out.write("\t\tvar form2 = new mini.Form(\"#form2\");\r\n");
      out.write("// \t\tvar form3 = new mini.Form(\"#form3\");\r\n");
      out.write("// \t\tvar form4= new mini.Form(\"#form4\");\r\n");
      out.write("\t\tvar invoiceNo = mini.get(\"#invoiceNo\");\r\n");
      out.write("\t\tvar win = mini.get(\"#win1\");\r\n");
      out.write("\t\tvar parentForm = new mini.Form(\"#parentForm\");\r\n");
      out.write("\t\tvar receiptNo = mini.get(\"receiptNo\");\r\n");
      out.write("\t\tvar grid2 = mini.get(\"grid2\");\r\n");
      out.write("\t\tvar grid3 = mini.get(\"grid3\");\r\n");
      out.write("\t\tvar grid4 = mini.get(\"grid4\");\r\n");
      out.write("\t\tvar grid5 = mini.get(\"grid5\");\r\n");
      out.write("\t\tvar patientId = mini.get(\"patientId\");\r\n");
      out.write("\t\tvar registerClass = mini.get(\"registerClass\");\r\n");
      out.write("\t\tvar patientName = mini.get(\"patientName\");\r\n");
      out.write("\t\tvar name = mini.get(\"name\");\r\n");
      out.write("\t\tvar birthDate = mini.get(\"birthDate\");\r\n");
      out.write("\t\tbirthDate.setMaxDate(new Date());\r\n");
      out.write("\t\tvar sexCode = mini.get(\"sexCode\");\r\n");
      out.write("\t\tvar idnetifierTypeId = mini.get(\"idnetifierTypeId\");\r\n");
      out.write("\t\tvar idnetifierNo = mini.get(\"idnetifierNo\");\r\n");
      out.write("\t\tvar ageNum = mini.get(\"ageNum\");\r\n");
      out.write("\t\tvar ageType = mini.get(\"ageType\");\r\n");
      out.write("\t\tvar patientMedicaltypeId = mini.get(\"patientMedicaltypeId\");\r\n");
      out.write("\t\tvar patientMedicaltypeKindId = mini.get(\"patientMedicaltypeKindId\");\r\n");
      out.write("\t\tvar reglevelId = mini.get(\"reglevelId\");\r\n");
      out.write("\t\tvar totalCost = mini.get(\"totalCost\");\r\n");
      out.write("\t\tvar totalPubCost = mini.get(\"totalPubCost\");\r\n");
      out.write("\t\tvar deptId = mini.get(\"deptId\");\r\n");
      out.write("\t\tvar doctId = mini.get(\"doctId\");\r\n");
      out.write("\t\tvar scheduleTimeId = mini.get(\"scheduleTimeId\");\r\n");
      out.write("\t\tvar scheduleId = mini.get(\"scheduleId\");\r\n");
      out.write("\t\tvar appointmentId = mini.get(\"appointmentId\");\r\n");
      out.write("\t\tgrid3.load({\r\n");
      out.write("\t\t\tseeDate: mini.formatDate(new Date(), \"yyyy-MM-dd\"),\r\n");
      out.write("\t\t\tcurrentHour: mini.formatDate(new Date(), \"H\")\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\tgrid4.load();\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tvar win2 = mini.get(\"#win2\");\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 无效行变红色\r\n");
      out.write("\t\tgrid4.on(\"drawcell\", function (e) {\r\n");
      out.write("\t\t\tvar record = e.record,\r\n");
      out.write("\t        column = e.column,\r\n");
      out.write("\t        field = e.field,\r\n");
      out.write("\t        value = e.value;\r\n");
      out.write("            if (record.validFlag == \"否\") {\r\n");
      out.write("                e.rowCls = \"myrow\";\r\n");
      out.write("            }\r\n");
      out.write("\t\t});\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 页面初始化时获取显示发票号时异常\r\n");
      out.write("\t\tvar state = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${invoice.state}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("\";\r\n");
      out.write("\t\tif(state != \"ok\") {\r\n");
      out.write("\t\t\tmini.alert(\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${invoice.msg}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("\");\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\t// 必须输入中英文\r\n");
      out.write("\t\tfunction onCnEnValidation(e) {\r\n");
      out.write("            if (e.isValid) {\r\n");
      out.write("                var reg = /^[\\u4E00-\\u9FA5A-Za-z]+$/;\r\n");
      out.write("                if(!reg.test(e.value)) {\r\n");
      out.write("                \te.errorText = \"必须输入中英文\";\r\n");
      out.write("                    e.isValid = false;\r\n");
      out.write("                }\r\n");
      out.write("            }\r\n");
      out.write("        }\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tshow();\r\n");
      out.write("\t\t\r\n");
      out.write("\t</script>\r\n");
      out.write("</body>\r\n");
      out.write("</html>\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }

  private boolean _jspx_meth_c_005fset_005f0(javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:set
    org.apache.taglibs.standard.tag.rt.core.SetTag _jspx_th_c_005fset_005f0 = (org.apache.taglibs.standard.tag.rt.core.SetTag) _005fjspx_005ftagPool_005fc_005fset_0026_005fvar_005fvalue_005fnobody.get(org.apache.taglibs.standard.tag.rt.core.SetTag.class);
    boolean _jspx_th_c_005fset_005f0_reused = false;
    try {
      _jspx_th_c_005fset_005f0.setPageContext(_jspx_page_context);
      _jspx_th_c_005fset_005f0.setParent(null);
      // /commons/include/form.jsp(5,0) name = var type = java.lang.String reqTime = false required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_c_005fset_005f0.setVar("ctx");
      // /commons/include/form.jsp(5,0) name = value type = javax.el.ValueExpression reqTime = true required = false fragment = false deferredValue = true expectedTypeName = java.lang.Object deferredMethod = false methodSignature = null
      _jspx_th_c_005fset_005f0.setValue(new org.apache.jasper.el.JspValueExpression("/commons/include/form.jsp(5,0) '${pageContext.request.contextPath}'",_jsp_getExpressionFactory().createValueExpression(_jspx_page_context.getELContext(),"${pageContext.request.contextPath}",java.lang.Object.class)).getValue(_jspx_page_context.getELContext()));
      int _jspx_eval_c_005fset_005f0 = _jspx_th_c_005fset_005f0.doStartTag();
      if (_jspx_th_c_005fset_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fc_005fset_0026_005fvar_005fvalue_005fnobody.reuse(_jspx_th_c_005fset_005f0);
      _jspx_th_c_005fset_005f0_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_c_005fset_005f0, _jsp_getInstanceManager(), _jspx_th_c_005fset_005f0_reused);
    }
    return false;
  }

  private boolean _jspx_meth_c_005fset_005f1(javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  c:set
    org.apache.taglibs.standard.tag.rt.core.SetTag _jspx_th_c_005fset_005f1 = (org.apache.taglibs.standard.tag.rt.core.SetTag) _005fjspx_005ftagPool_005fc_005fset_0026_005fvar_005fvalue_005fnobody.get(org.apache.taglibs.standard.tag.rt.core.SetTag.class);
    boolean _jspx_th_c_005fset_005f1_reused = false;
    try {
      _jspx_th_c_005fset_005f1.setPageContext(_jspx_page_context);
      _jspx_th_c_005fset_005f1.setParent(null);
      // /commons/include/form.jsp(6,0) name = var type = java.lang.String reqTime = false required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_c_005fset_005f1.setVar("ctx_rpt");
      // /commons/include/form.jsp(6,0) name = value type = javax.el.ValueExpression reqTime = true required = false fragment = false deferredValue = true expectedTypeName = java.lang.Object deferredMethod = false methodSignature = null
      _jspx_th_c_005fset_005f1.setValue(new org.apache.jasper.el.JspValueExpression("/commons/include/form.jsp(6,0) '${reportContextPath}'",_jsp_getExpressionFactory().createValueExpression(_jspx_page_context.getELContext(),"${reportContextPath}",java.lang.Object.class)).getValue(_jspx_page_context.getELContext()));
      int _jspx_eval_c_005fset_005f1 = _jspx_th_c_005fset_005f1.doStartTag();
      if (_jspx_th_c_005fset_005f1.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fc_005fset_0026_005fvar_005fvalue_005fnobody.reuse(_jspx_th_c_005fset_005f1);
      _jspx_th_c_005fset_005f1_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_c_005fset_005f1, _jsp_getInstanceManager(), _jspx_th_c_005fset_005f1_reused);
    }
    return false;
  }
}
